(function(xe,et){typeof exports=="object"&&typeof module<"u"?et(exports):typeof define=="function"&&define.amd?define(["exports"],et):(xe=typeof globalThis<"u"?globalThis:xe||self,et(xe["@walletconnect/sign-client"]={}))})(this,function(xe){"use strict";var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var lt={exports:{}},tr=typeof Reflect=="object"?Reflect:null,Cn=tr&&typeof tr.apply=="function"?tr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},zr;tr&&typeof tr.ownKeys=="function"?zr=tr.ownKeys:Object.getOwnPropertySymbols?zr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:zr=function(e){return Object.getOwnPropertyNames(e)};function ka(t){console&&console.warn&&console.warn(t)}var Ln=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}lt.exports=Oe,lt.exports.once=Za,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var Fn=10;function Br(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return Fn},set:function(t){if(typeof t!="number"||t<0||Ln(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Fn=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ln(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Un(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return Un(this)},Oe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Cn(l,this,r);else for(var h=l.length,p=Bn(l,h),i=0;i<h;++i)Cn(p[i],this,r);return!0};function $n(t,e,r,i){var n,s,a;if(Br(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),n=Un(t),n>0&&a.length>n&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,ka(u)}return t}Oe.prototype.addListener=function(e,r){return $n(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return $n(this,e,r,!0)};function Xa(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Mn(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Xa.bind(i);return n.listener=r,i.wrapFn=n,n}Oe.prototype.once=function(e,r){return Br(r),this.on(e,Mn(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return Br(r),this.prependListener(e,Mn(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var i,n,s,a,u;if(Br(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===r||i[a].listener===r){u=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():Ja(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(n=0;n<s.length;++n)a=s[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function jn(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Qa(n):Bn(n,n.length)}Oe.prototype.listeners=function(e){return jn(this,e,!0)},Oe.prototype.rawListeners=function(e){return jn(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):zn.call(t,e)},Oe.prototype.listenerCount=zn;function zn(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?zr(this._events):[]};function Bn(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Ja(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Qa(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Za(t,e){return new Promise(function(r,i){function n(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}qn(t,e,s,{once:!0}),e!=="error"&&ec(t,n,{once:!0})})}function ec(t,e,r){typeof t.on=="function"&&qn(t,"error",e,r)}function qn(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var qr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var bi=function(t,e){return bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},bi(t,e)};function tc(t,e){bi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var wi=function(){return wi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},wi.apply(this,arguments)};function rc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ic(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function nc(t,e){return function(r,i){e(r,i,t)}}function sc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function oc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{h(i.next(p))}catch(v){a(v)}}function l(p){try{h(i.throw(p))}catch(v){a(v)}}function h(p){p.done?s(p.value):n(p.value).then(u,l)}h((i=i.apply(t,e||[])).next())})}function ac(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(h){return function(p){return l([h,p])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function cc(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function uc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function vi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function hc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Kn(arguments[e]));return t}function lc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function hr(t){return this instanceof hr?(this.v=t,this):new hr(t)}function fc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(_){i[_]&&(n[_]=function(m){return new Promise(function(S,A){s.push([_,m,S,A])>1||u(_,m)})})}function u(_,m){try{l(i[_](m))}catch(S){v(s[0][3],S)}}function l(_){_.value instanceof hr?Promise.resolve(_.value.v).then(h,p):v(s[0][2],_)}function h(_){u("next",_)}function p(_){u("throw",_)}function v(_,m){_(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function dc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:hr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function pc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof vi=="function"?vi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,l){a=t[s](a),n(u,l,a.done,a.value)})}}function n(s,a,u,l){Promise.resolve(l).then(function(h){s({value:h,done:u})},a)}}function gc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function yc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _c(t){return t&&t.__esModule?t:{default:t}}function bc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function wc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var vc=Object.freeze({__proto__:null,__extends:tc,get __assign(){return wi},__rest:rc,__decorate:ic,__param:nc,__metadata:sc,__awaiter:oc,__generator:ac,__createBinding:cc,__exportStar:uc,__values:vi,__read:Kn,__spread:hc,__spreadArrays:lc,__await:hr,__asyncGenerator:fc,__asyncDelegator:dc,__asyncValues:pc,__makeTemplateObject:gc,__importStar:yc,__importDefault:_c,__classPrivateFieldGet:bc,__classPrivateFieldSet:wc}),Hn=Bt(vc),lr={};Object.defineProperty(lr,"__esModule",{value:!0});function mc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}lr.safeJsonParse=mc;function Ec(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}lr.safeJsonStringify=Ec;var fr={exports:{}},Vn;function Sc(){return Vn||(Vn=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof et<"u"&&et.localStorage?fr.exports=et.localStorage:typeof window<"u"&&window.localStorage?fr.exports=window.localStorage:fr.exports=new e}()),fr.exports}var mi={},dr={},Gn;function Dc(){if(Gn)return dr;Gn=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.IKeyValueStorage=void 0;class t{}return dr.IKeyValueStorage=t,dr}var pr={},Wn;function Oc(){if(Wn)return pr;Wn=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.parseEntry=void 0;const t=lr;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return pr.parseEntry=e,pr}var Yn;function xc(){return Yn||(Yn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hn;e.__exportStar(Dc(),t),e.__exportStar(Oc(),t)}(mi)),mi}Object.defineProperty(qr,"__esModule",{value:!0}),qr.KeyValueStorage=void 0;const rr=Hn,kn=lr,Ic=rr.__importDefault(Sc()),Tc=xc();class Xn{constructor(){this.localStorage=Ic.default}getKeys(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Tc.parseEntry)})}getItem(e){return rr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return kn.safeJsonParse(r)})}setItem(e,r){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,kn.safeJsonStringify(r))})}removeItem(e){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}qr.KeyValueStorage=Xn;var Nc=qr.default=Xn,gr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ei=function(t,e){return Ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ei(t,e)};function Pc(t,e){Ei(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Si=function(){return Si=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Si.apply(this,arguments)};function Ac(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Rc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Cc(t,e){return function(r,i){e(r,i,t)}}function Lc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Fc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{h(i.next(p))}catch(v){a(v)}}function l(p){try{h(i.throw(p))}catch(v){a(v)}}function h(p){p.done?s(p.value):n(p.value).then(u,l)}h((i=i.apply(t,e||[])).next())})}function Uc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(h){return function(p){return l([h,p])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function $c(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Mc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Di(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function jc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Jn(arguments[e]));return t}function zc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function yr(t){return this instanceof yr?(this.v=t,this):new yr(t)}function Bc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(_){i[_]&&(n[_]=function(m){return new Promise(function(S,A){s.push([_,m,S,A])>1||u(_,m)})})}function u(_,m){try{l(i[_](m))}catch(S){v(s[0][3],S)}}function l(_){_.value instanceof yr?Promise.resolve(_.value.v).then(h,p):v(s[0][2],_)}function h(_){u("next",_)}function p(_){u("throw",_)}function v(_,m){_(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function qc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:yr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Kc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Di=="function"?Di(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,l){a=t[s](a),n(u,l,a.done,a.value)})}}function n(s,a,u,l){Promise.resolve(l).then(function(h){s({value:h,done:u})},a)}}function Hc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Vc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Gc(t){return t&&t.__esModule?t:{default:t}}function Wc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Yc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var kc=Object.freeze({__proto__:null,__extends:Pc,get __assign(){return Si},__rest:Ac,__decorate:Rc,__param:Cc,__metadata:Lc,__awaiter:Fc,__generator:Uc,__createBinding:$c,__exportStar:Mc,__values:Di,__read:Jn,__spread:jc,__spreadArrays:zc,__await:yr,__asyncGenerator:Bc,__asyncDelegator:qc,__asyncValues:Kc,__makeTemplateObject:Hc,__importStar:Vc,__importDefault:Gc,__classPrivateFieldGet:Wc,__classPrivateFieldSet:Yc}),Kr=Bt(kc),_r={},Q={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Oi=function(t,e){return Oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Oi(t,e)};function Xc(t,e){Oi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xi=function(){return xi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xi.apply(this,arguments)};function Jc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Qc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Zc(t,e){return function(r,i){e(r,i,t)}}function eu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function tu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{h(i.next(p))}catch(v){a(v)}}function l(p){try{h(i.throw(p))}catch(v){a(v)}}function h(p){p.done?s(p.value):n(p.value).then(u,l)}h((i=i.apply(t,e||[])).next())})}function ru(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(h){return function(p){return l([h,p])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function iu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function nu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ii(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function su(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Qn(arguments[e]));return t}function ou(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function br(t){return this instanceof br?(this.v=t,this):new br(t)}function au(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(_){i[_]&&(n[_]=function(m){return new Promise(function(S,A){s.push([_,m,S,A])>1||u(_,m)})})}function u(_,m){try{l(i[_](m))}catch(S){v(s[0][3],S)}}function l(_){_.value instanceof br?Promise.resolve(_.value.v).then(h,p):v(s[0][2],_)}function h(_){u("next",_)}function p(_){u("throw",_)}function v(_,m){_(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function cu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:br(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function uu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ii=="function"?Ii(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,l){a=t[s](a),n(u,l,a.done,a.value)})}}function n(s,a,u,l){Promise.resolve(l).then(function(h){s({value:h,done:u})},a)}}function hu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function lu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function fu(t){return t&&t.__esModule?t:{default:t}}function du(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function pu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var gu=Object.freeze({__proto__:null,__extends:Xc,get __assign(){return xi},__rest:Jc,__decorate:Qc,__param:Zc,__metadata:eu,__awaiter:tu,__generator:ru,__createBinding:iu,__exportStar:nu,__values:Ii,__read:Qn,__spread:su,__spreadArrays:ou,__await:br,__asyncGenerator:au,__asyncDelegator:cu,__asyncValues:uu,__makeTemplateObject:hu,__importStar:lu,__importDefault:fu,__classPrivateFieldGet:du,__classPrivateFieldSet:pu}),Hr=Bt(gu),Ti={},wr={},Zn;function yu(){if(Zn)return wr;Zn=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return wr.delay=t,wr}var qt={},Ni={},Kt={},es;function _u(){return es||(es=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ONE_THOUSAND=Kt.ONE_HUNDRED=void 0,Kt.ONE_HUNDRED=100,Kt.ONE_THOUSAND=1e3),Kt}var Pi={},ts;function bu(){return ts||(ts=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Pi)),Pi}var rs;function is(){return rs||(rs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(_u(),t),e.__exportStar(bu(),t)}(Ni)),Ni}var ns;function wu(){if(ns)return qt;ns=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.fromMiliseconds=qt.toMiliseconds=void 0;const t=is();function e(i){return i*t.ONE_THOUSAND}qt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return qt.fromMiliseconds=r,qt}var ss;function vu(){return ss||(ss=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(yu(),t),e.__exportStar(wu(),t)}(Ti)),Ti}var ir={},os;function mu(){if(os)return ir;os=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return ir.Watch=t,ir.default=t,ir}var Ai={},vr={},as;function Eu(){if(as)return vr;as=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IWatch=void 0;class t{}return vr.IWatch=t,vr}var cs;function Su(){return cs||(cs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Hr.__exportStar(Eu(),t)}(Ai)),Ai}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(vu(),t),e.__exportStar(mu(),t),e.__exportStar(Su(),t),e.__exportStar(is(),t)})(Q);var Ri={},mr={};class Ht{}var Du=Object.freeze({__proto__:null,IEvents:Ht}),Ou=Bt(Du),us;function xu(){if(us)return mr;us=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IHeartBeat=void 0;const t=Ou;class e extends t.IEvents{constructor(i){super()}}return mr.IHeartBeat=e,mr}var hs;function ls(){return hs||(hs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Kr.__exportStar(xu(),t)}(Ri)),Ri}var Ci={},Vt={},fs;function Iu(){if(fs)return Vt;fs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.HEARTBEAT_EVENTS=Vt.HEARTBEAT_INTERVAL=void 0;const t=Q;return Vt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Vt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vt}var ds;function ps(){return ds||(ds=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Kr.__exportStar(Iu(),t)}(Ci)),Ci}var gs;function Tu(){if(gs)return _r;gs=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.HeartBeat=void 0;const t=Kr,e=lt.exports,r=Q,i=ls(),n=ps();class s extends i.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=u?.interval||n.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const l=new s(u);return yield l.init(),l})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,l){this.events.on(u,l)}once(u,l){this.events.once(u,l)}off(u,l){this.events.off(u,l)}removeListener(u,l){this.events.removeListener(u,l)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return _r.HeartBeat=s,_r}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Kr;e.__exportStar(Tu(),t),e.__exportStar(ls(),t),e.__exportStar(ps(),t)})(gr);var _e={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Li=function(t,e){return Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Li(t,e)};function Nu(t,e){Li(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fi=function(){return Fi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fi.apply(this,arguments)};function Pu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Au(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Ru(t,e){return function(r,i){e(r,i,t)}}function Cu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Lu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{h(i.next(p))}catch(v){a(v)}}function l(p){try{h(i.throw(p))}catch(v){a(v)}}function h(p){p.done?s(p.value):n(p.value).then(u,l)}h((i=i.apply(t,e||[])).next())})}function Fu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(h){return function(p){return l([h,p])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Uu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function $u(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ui(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ys(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Mu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ys(arguments[e]));return t}function ju(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function Er(t){return this instanceof Er?(this.v=t,this):new Er(t)}function zu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(_){i[_]&&(n[_]=function(m){return new Promise(function(S,A){s.push([_,m,S,A])>1||u(_,m)})})}function u(_,m){try{l(i[_](m))}catch(S){v(s[0][3],S)}}function l(_){_.value instanceof Er?Promise.resolve(_.value.v).then(h,p):v(s[0][2],_)}function h(_){u("next",_)}function p(_){u("throw",_)}function v(_,m){_(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Bu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Er(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function qu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ui=="function"?Ui(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,l){a=t[s](a),n(u,l,a.done,a.value)})}}function n(s,a,u,l){Promise.resolve(l).then(function(h){s({value:h,done:u})},a)}}function Ku(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Hu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Vu(t){return t&&t.__esModule?t:{default:t}}function Gu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Wu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Yu=Object.freeze({__proto__:null,__extends:Nu,get __assign(){return Fi},__rest:Pu,__decorate:Au,__param:Ru,__metadata:Cu,__awaiter:Lu,__generator:Fu,__createBinding:Uu,__exportStar:$u,__values:Ui,__read:ys,__spread:Mu,__spreadArrays:ju,__await:Er,__asyncGenerator:zu,__asyncDelegator:Bu,__asyncValues:qu,__makeTemplateObject:Ku,__importStar:Hu,__importDefault:Vu,__classPrivateFieldGet:Gu,__classPrivateFieldSet:Wu}),ku=Bt(Yu),$i,_s;function Xu(){if(_s)return $i;_s=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}$i=e;function e(r,i,n){var s=n&&n.stringify||t,a=1;if(typeof r=="object"&&r!==null){var u=i.length+a;if(u===1)return r;var l=new Array(u);l[0]=s(r);for(var h=1;h<u;h++)l[h]=s(i[h]);return l.join(" ")}if(typeof r!="string")return r;var p=i.length;if(p===0)return r;for(var v="",_=1-a,m=-1,S=r&&r.length||0,A=0;A<S;){if(r.charCodeAt(A)===37&&A+1<S){switch(m=m>-1?m:0,r.charCodeAt(A+1)){case 100:case 102:if(_>=p||i[_]==null)break;m<A&&(v+=r.slice(m,A)),v+=Number(i[_]),m=A+2,A++;break;case 105:if(_>=p||i[_]==null)break;m<A&&(v+=r.slice(m,A)),v+=Math.floor(Number(i[_])),m=A+2,A++;break;case 79:case 111:case 106:if(_>=p||i[_]===void 0)break;m<A&&(v+=r.slice(m,A));var R=typeof i[_];if(R==="string"){v+="'"+i[_]+"'",m=A+2,A++;break}if(R==="function"){v+=i[_].name||"<anonymous>",m=A+2,A++;break}v+=s(i[_]),m=A+2,A++;break;case 115:if(_>=p)break;m<A&&(v+=r.slice(m,A)),v+=String(i[_]),m=A+2,A++;break;case 37:m<A&&(v+=r.slice(m,A)),v+="%",m=A+2,A++,_--;break}++_}++A}return m===-1?r:(m<S&&(v+=r.slice(m)),v)}return $i}var Mi,bs;function Ju(){if(bs)return Mi;bs=1;const t=Xu();Mi=n;const e=w().console||{},r={mapHttpRequest:S,mapHttpResponse:S,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:S,res:S,err:_};function i(d,o){return Array.isArray(d)?d.filter(function(C){return C!=="!stdSerializers.err"}):d===!0?Object.keys(o):!1}function n(d){d=d||{},d.browser=d.browser||{};const o=d.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const f=d.browser.write||e;d.browser.write&&(d.browser.asObject=!0);const C=d.serializers||{},L=i(d.browser.serialize,C);let K=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(K=!1);const G=["error","fatal","warn","info","debug","trace"];typeof f=="function"&&(f.error=f.fatal=f.warn=f.info=f.debug=f.trace=f),d.enabled===!1&&(d.level="silent");const J=d.level||"info",x=Object.create(f);x.log||(x.log=R),Object.defineProperty(x,"levelVal",{get:W}),Object.defineProperty(x,"level",{get:j,set:U});const P={transmit:o,serialize:L,asObject:d.browser.asObject,levels:G,timestamp:m(d)};x.levels=n.levels,x.level=J,x.setMaxListeners=x.getMaxListeners=x.emit=x.addListener=x.on=x.prependListener=x.once=x.prependOnceListener=x.removeListener=x.removeAllListeners=x.listeners=x.listenerCount=x.eventNames=x.write=x.flush=R,x.serializers=C,x._serialize=L,x._stdErrSerialize=K,x.child=M,o&&(x._logEvent=v());function W(){return this.level==="silent"?1/0:this.levels.values[this.level]}function j(){return this._level}function U(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,s(P,x,"error","log"),s(P,x,"fatal","error"),s(P,x,"warn","error"),s(P,x,"info","log"),s(P,x,"debug","log"),s(P,x,"trace","log")}function M(F,z){if(!F)throw new Error("missing bindings for child Pino");z=z||{},L&&F.serializers&&(z.serializers=F.serializers);const te=z.serializers;if(L&&te){var B=Object.assign({},C,te),Z=d.browser.serialize===!0?Object.keys(B):L;delete F.serializers,l([F],Z,B,this._stdErrSerialize)}function k(ee){this._childLevel=(ee._childLevel|0)+1,this.error=h(ee,F,"error"),this.fatal=h(ee,F,"fatal"),this.warn=h(ee,F,"warn"),this.info=h(ee,F,"info"),this.debug=h(ee,F,"debug"),this.trace=h(ee,F,"trace"),B&&(this.serializers=B,this._serialize=Z),o&&(this._logEvent=v([].concat(ee._logEvent.bindings,F)))}return k.prototype=this,new k(this)}return x}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:q,epochTime:E,unixTime:I,isoTime:y});function s(d,o,f,C){const L=Object.getPrototypeOf(o);o[f]=o.levelVal>o.levels.values[f]?R:L[f]?L[f]:e[f]||e[C]||R,a(d,o,f)}function a(d,o,f){!d.transmit&&o[f]===R||(o[f]=function(C){return function(){const K=d.timestamp(),G=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var x=0;x<G.length;x++)G[x]=arguments[x];if(d.serialize&&!d.asObject&&l(G,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?C.call(J,u(this,f,G,K)):C.apply(J,G),d.transmit){const P=d.transmit.level||o.level,W=n.levels.values[P],j=n.levels.values[f];if(j<W)return;p(this,{ts:K,methodLevel:f,methodValue:j,transmitLevel:P,transmitValue:n.levels.values[d.transmit.level||o.level],send:d.transmit.send,val:o.levelVal},G)}}}(o[f]))}function u(d,o,f,C){d._serialize&&l(f,d._serialize,d.serializers,d._stdErrSerialize);const L=f.slice();let K=L[0];const G={};C&&(G.time=C),G.level=n.levels.values[o];let J=(d._childLevel|0)+1;if(J<1&&(J=1),K!==null&&typeof K=="object"){for(;J--&&typeof L[0]=="object";)Object.assign(G,L.shift());K=L.length?t(L.shift(),L):void 0}else typeof K=="string"&&(K=t(L.shift(),L));return K!==void 0&&(G.msg=K),G}function l(d,o,f,C){for(const L in d)if(C&&d[L]instanceof Error)d[L]=n.stdSerializers.err(d[L]);else if(typeof d[L]=="object"&&!Array.isArray(d[L]))for(const K in d[L])o&&o.indexOf(K)>-1&&K in f&&(d[L][K]=f[K](d[L][K]))}function h(d,o,f){return function(){const C=new Array(1+arguments.length);C[0]=o;for(var L=1;L<C.length;L++)C[L]=arguments[L-1];return d[f].apply(this,C)}}function p(d,o,f){const C=o.send,L=o.ts,K=o.methodLevel,G=o.methodValue,J=o.val,x=d._logEvent.bindings;l(f,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=L,d._logEvent.messages=f.filter(function(P){return x.indexOf(P)===-1}),d._logEvent.level.label=K,d._logEvent.level.value=G,C(K,d._logEvent,J),d._logEvent=v(x)}function v(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function _(d){const o={type:d.constructor.name,msg:d.message,stack:d.stack};for(const f in d)o[f]===void 0&&(o[f]=d[f]);return o}function m(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?q:E}function S(){return{}}function A(d){return d}function R(){}function q(){return!1}function E(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function y(){return new Date(Date.now()).toISOString()}function w(){function d(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return Mi}var Gt={},ws;function vs(){return ws||(ws=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.PINO_CUSTOM_CONTEXT_KEY=Gt.PINO_LOGGER_DEFAULTS=void 0,Gt.PINO_LOGGER_DEFAULTS={level:"info"},Gt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gt}var ot={},ms;function Qu(){if(ms)return ot;ms=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=vs();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(u,l=t.PINO_CUSTOM_CONTEXT_KEY){return u[l]||""}ot.getBrowserLoggerContext=r;function i(u,l,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]=l,u}ot.setBrowserLoggerContext=i;function n(u,l=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof u.bindings>"u"?h=r(u,l):h=u.bindings().context||"",h}ot.getLoggerContext=n;function s(u,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const p=n(u,h);return p.trim()?`${p}/${l}`:l}ot.formatChildLoggerContext=s;function a(u,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const p=s(u,l,h),v=u.child({context:p});return i(v,p,h)}return ot.generateChildLogger=a,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=ku,r=e.__importDefault(Ju());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(vs(),t),e.__exportStar(Qu(),t)})(_e);class Zu extends Ht{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class eh extends Ht{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class th{constructor(e,r){this.logger=e,this.core=r}}class rh extends Ht{constructor(e,r){super(),this.relayer=e,this.logger=r}}class ih extends Ht{constructor(e){super()}}class nh{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class sh extends Ht{constructor(e,r){super(),this.relayer=e,this.logger=r}}class oh extends Ht{constructor(e,r){super(),this.core=e,this.logger=r}}class ah{constructor(e,r){this.projectId=e,this.logger=r}}class ch{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class uh{constructor(e){this.client=e}}const hh=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),lh=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Es(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return lh(t)}catch{return t}}function ji(t){return typeof t=="string"?t:hh(t)||""}var zi={},nr={},Vr={},Gr={};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.BrowserRandomSource=void 0;const Ss=65536;class fh{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=Ss)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Ss)));return r}}Gr.BrowserRandomSource=fh;function dh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wr={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function ph(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=ph;var gh={},yh=Object.freeze({__proto__:null,default:gh}),_h=Bt(yh);Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.NodeRandomSource=void 0;const bh=pt;class wh{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof dh<"u"){const e=_h;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,bh.wipe)(r),i}}Wr.NodeRandomSource=wh,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.SystemRandomSource=void 0;const vh=Gr,mh=Wr;class Eh{constructor(){if(this.isAvailable=!1,this.name="",this._source=new vh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new mh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Vr.SystemRandomSource=Eh;var ie={},Ds={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,l){var h=u>>>16&65535,p=u&65535,v=l>>>16&65535,_=l&65535;return p*_+(h*_+p*v<<16>>>0)|0}t.mul=Math.imul||e;function r(u,l){return u+l|0}t.add=r;function i(u,l){return u-l|0}t.sub=i;function n(u,l){return u<<l|u>>>32-l}t.rotl=n;function s(u,l){return u<<32-l|u>>>l}t.rotr=s;function a(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(Ds),Object.defineProperty(ie,"__esModule",{value:!0});var Os=Ds;function Sh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ie.readInt16BE=Sh;function Dh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ie.readUint16BE=Dh;function Oh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ie.readInt16LE=Oh;function xh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ie.readUint16LE=xh;function xs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ie.writeUint16BE=xs,ie.writeInt16BE=xs;function Is(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ie.writeUint16LE=Is,ie.writeInt16LE=Is;function Bi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ie.readInt32BE=Bi;function qi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ie.readUint32BE=qi;function Ki(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ie.readInt32LE=Ki;function Hi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ie.readUint32LE=Hi;function Yr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ie.writeUint32BE=Yr,ie.writeInt32BE=Yr;function kr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ie.writeUint32LE=kr,ie.writeInt32LE=kr;function Ih(t,e){e===void 0&&(e=0);var r=Bi(t,e),i=Bi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=Ih;function Th(t,e){e===void 0&&(e=0);var r=qi(t,e),i=qi(t,e+4);return r*4294967296+i}ie.readUint64BE=Th;function Nh(t,e){e===void 0&&(e=0);var r=Ki(t,e),i=Ki(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ie.readInt64LE=Nh;function Ph(t,e){e===void 0&&(e=0);var r=Hi(t,e),i=Hi(t,e+4);return i*4294967296+r}ie.readUint64LE=Ph;function Ts(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Yr(t/4294967296>>>0,e,r),Yr(t>>>0,e,r+4),e}ie.writeUint64BE=Ts,ie.writeInt64BE=Ts;function Ns(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),kr(t>>>0,e,r),kr(t/4294967296>>>0,e,r+4),e}ie.writeUint64LE=Ns,ie.writeInt64LE=Ns;function Ah(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ie.readUintBE=Ah;function Rh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ie.readUintLE=Rh;function Ch(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Os.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ie.writeUintBE=Ch;function Lh(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Os.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ie.writeUintLE=Lh;function Fh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ie.readFloat32BE=Fh;function Uh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ie.readFloat32LE=Uh;function $h(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ie.readFloat64BE=$h;function Mh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ie.readFloat64LE=Mh;function jh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ie.writeFloat32BE=jh;function zh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ie.writeFloat32LE=zh;function Bh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ie.writeFloat64BE=Bh;function qh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ie.writeFloat64LE=qh,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Vr,r=ie,i=pt;t.defaultRandomSource=new e.SystemRandomSource;function n(h,p=t.defaultRandomSource){return p.randomBytes(h)}t.randomBytes=n;function s(h=t.defaultRandomSource){const p=n(4,h),v=(0,r.readUint32LE)(p);return(0,i.wipe)(p),v}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(h,p=a,v=t.defaultRandomSource){if(p.length<2)throw new Error("randomString charset is too short");if(p.length>256)throw new Error("randomString charset is too long");let _="";const m=p.length,S=256-256%m;for(;h>0;){const A=n(Math.ceil(h*256/S),v);for(let R=0;R<A.length&&h>0;R++){const q=A[R];q<S&&(_+=p.charAt(q%m),h--)}(0,i.wipe)(A)}return _}t.randomString=u;function l(h,p=a,v=t.defaultRandomSource){const _=Math.ceil(h/(Math.log(p.length)/Math.LN2));return u(_,p,v)}t.randomStringForEntropy=l}(nr);var Ps={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var p=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=l[p++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(p=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,p,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[p++],h--;return this},u.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,p=this._bufferLength,v=h/536870912|0,_=h<<3,m=h%128<112?128:256;this._buffer[p]=128;for(var S=p+1;S<m-8;S++)this._buffer[S]=0;e.writeUint32BE(v,this._buffer,m-8),e.writeUint32BE(_,this._buffer,m-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)e.writeUint32BE(this._stateHi[S],l,S*8),e.writeUint32BE(this._stateLo[S],l,S*8+4);return this},u.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},u}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,l,h,p,v,_,m){for(var S=h[0],A=h[1],R=h[2],q=h[3],E=h[4],I=h[5],y=h[6],w=h[7],d=p[0],o=p[1],f=p[2],C=p[3],L=p[4],K=p[5],G=p[6],J=p[7],x,P,W,j,U,M,F,z;m>=128;){for(var te=0;te<16;te++){var B=8*te+_;u[te]=e.readUint32BE(v,B),l[te]=e.readUint32BE(v,B+4)}for(var te=0;te<80;te++){var Z=S,k=A,ee=R,N=q,T=E,D=I,c=y,b=w,H=d,Y=o,le=f,be=C,de=L,me=K,Fe=G,Ae=J;if(x=w,P=J,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=(E>>>14|L<<32-14)^(E>>>18|L<<32-18)^(L>>>41-32|E<<32-(41-32)),P=(L>>>14|E<<32-14)^(L>>>18|E<<32-18)^(E>>>41-32|L<<32-(41-32)),U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,x=E&I^~E&y,P=L&K^~L&G,U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,x=n[te*2],P=n[te*2+1],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,x=u[te%16],P=l[te%16],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,W=F&65535|z<<16,j=U&65535|M<<16,x=W,P=j,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=(S>>>28|d<<32-28)^(d>>>34-32|S<<32-(34-32))^(d>>>39-32|S<<32-(39-32)),P=(d>>>28|S<<32-28)^(S>>>34-32|d<<32-(34-32))^(S>>>39-32|d<<32-(39-32)),U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,x=S&A^S&R^A&R,P=d&o^d&f^o&f,U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,b=F&65535|z<<16,Ae=U&65535|M<<16,x=N,P=be,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=W,P=j,U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,N=F&65535|z<<16,be=U&65535|M<<16,A=Z,R=k,q=ee,E=N,I=T,y=D,w=c,S=b,o=H,f=Y,C=le,L=be,K=de,G=me,J=Fe,d=Ae,te%16===15)for(var B=0;B<16;B++)x=u[B],P=l[B],U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=u[(B+9)%16],P=l[(B+9)%16],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,W=u[(B+1)%16],j=l[(B+1)%16],x=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,P=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,W=u[(B+14)%16],j=l[(B+14)%16],x=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,P=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,u[B]=F&65535|z<<16,l[B]=U&65535|M<<16}x=S,P=d,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[0],P=p[0],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[0]=S=F&65535|z<<16,p[0]=d=U&65535|M<<16,x=A,P=o,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[1],P=p[1],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[1]=A=F&65535|z<<16,p[1]=o=U&65535|M<<16,x=R,P=f,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[2],P=p[2],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[2]=R=F&65535|z<<16,p[2]=f=U&65535|M<<16,x=q,P=C,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[3],P=p[3],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[3]=q=F&65535|z<<16,p[3]=C=U&65535|M<<16,x=E,P=L,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[4],P=p[4],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[4]=E=F&65535|z<<16,p[4]=L=U&65535|M<<16,x=I,P=K,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[5],P=p[5],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[5]=I=F&65535|z<<16,p[5]=K=U&65535|M<<16,x=y,P=G,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[6],P=p[6],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[6]=y=F&65535|z<<16,p[6]=G=U&65535|M<<16,x=w,P=J,U=P&65535,M=P>>>16,F=x&65535,z=x>>>16,x=h[7],P=p[7],U+=P&65535,M+=P>>>16,F+=x&65535,z+=x>>>16,M+=U>>>16,F+=M>>>16,z+=F>>>16,h[7]=w=F&65535|z<<16,p[7]=J=U&65535|M<<16,_+=128,m-=128}return _}function a(u){var l=new i;l.update(u);var h=l.digest();return l.clean(),h}t.hash=a})(Ps),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=nr,r=Ps,i=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(N){const T=new Float64Array(16);if(N)for(let D=0;D<N.length;D++)T[D]=N[D];return T}const s=new Uint8Array(32);s[0]=9;const a=n(),u=n([1]),l=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),v=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(N,T){for(let D=0;D<16;D++)N[D]=T[D]|0}function S(N){let T=1;for(let D=0;D<16;D++){let c=N[D]+T+65535;T=Math.floor(c/65536),N[D]=c-T*65536}N[0]+=T-1+37*(T-1)}function A(N,T,D){const c=~(D-1);for(let b=0;b<16;b++){const H=c&(N[b]^T[b]);N[b]^=H,T[b]^=H}}function R(N,T){const D=n(),c=n();for(let b=0;b<16;b++)c[b]=T[b];S(c),S(c),S(c);for(let b=0;b<2;b++){D[0]=c[0]-65517;for(let Y=1;Y<15;Y++)D[Y]=c[Y]-65535-(D[Y-1]>>16&1),D[Y-1]&=65535;D[15]=c[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,A(c,D,1-H)}for(let b=0;b<16;b++)N[2*b]=c[b]&255,N[2*b+1]=c[b]>>8}function q(N,T){let D=0;for(let c=0;c<32;c++)D|=N[c]^T[c];return(1&D-1>>>8)-1}function E(N,T){const D=new Uint8Array(32),c=new Uint8Array(32);return R(D,N),R(c,T),q(D,c)}function I(N){const T=new Uint8Array(32);return R(T,N),T[0]&1}function y(N,T){for(let D=0;D<16;D++)N[D]=T[2*D]+(T[2*D+1]<<8);N[15]&=32767}function w(N,T,D){for(let c=0;c<16;c++)N[c]=T[c]+D[c]}function d(N,T,D){for(let c=0;c<16;c++)N[c]=T[c]-D[c]}function o(N,T,D){let c,b,H=0,Y=0,le=0,be=0,de=0,me=0,Fe=0,Ae=0,ye=0,pe=0,fe=0,ue=0,ce=0,ae=0,oe=0,re=0,he=0,ge=0,ne=0,we=0,ve=0,Se=0,De=0,Ee=0,St=0,Tt=0,$t=0,gt=0,Jt=0,$r=0,li=0,$e=D[0],Re=D[1],Me=D[2],je=D[3],ze=D[4],Ce=D[5],Ge=D[6],We=D[7],Ye=D[8],ke=D[9],Xe=D[10],qe=D[11],Be=D[12],Ne=D[13],Je=D[14],Qe=D[15];c=T[0],H+=c*$e,Y+=c*Re,le+=c*Me,be+=c*je,de+=c*ze,me+=c*Ce,Fe+=c*Ge,Ae+=c*We,ye+=c*Ye,pe+=c*ke,fe+=c*Xe,ue+=c*qe,ce+=c*Be,ae+=c*Ne,oe+=c*Je,re+=c*Qe,c=T[1],Y+=c*$e,le+=c*Re,be+=c*Me,de+=c*je,me+=c*ze,Fe+=c*Ce,Ae+=c*Ge,ye+=c*We,pe+=c*Ye,fe+=c*ke,ue+=c*Xe,ce+=c*qe,ae+=c*Be,oe+=c*Ne,re+=c*Je,he+=c*Qe,c=T[2],le+=c*$e,be+=c*Re,de+=c*Me,me+=c*je,Fe+=c*ze,Ae+=c*Ce,ye+=c*Ge,pe+=c*We,fe+=c*Ye,ue+=c*ke,ce+=c*Xe,ae+=c*qe,oe+=c*Be,re+=c*Ne,he+=c*Je,ge+=c*Qe,c=T[3],be+=c*$e,de+=c*Re,me+=c*Me,Fe+=c*je,Ae+=c*ze,ye+=c*Ce,pe+=c*Ge,fe+=c*We,ue+=c*Ye,ce+=c*ke,ae+=c*Xe,oe+=c*qe,re+=c*Be,he+=c*Ne,ge+=c*Je,ne+=c*Qe,c=T[4],de+=c*$e,me+=c*Re,Fe+=c*Me,Ae+=c*je,ye+=c*ze,pe+=c*Ce,fe+=c*Ge,ue+=c*We,ce+=c*Ye,ae+=c*ke,oe+=c*Xe,re+=c*qe,he+=c*Be,ge+=c*Ne,ne+=c*Je,we+=c*Qe,c=T[5],me+=c*$e,Fe+=c*Re,Ae+=c*Me,ye+=c*je,pe+=c*ze,fe+=c*Ce,ue+=c*Ge,ce+=c*We,ae+=c*Ye,oe+=c*ke,re+=c*Xe,he+=c*qe,ge+=c*Be,ne+=c*Ne,we+=c*Je,ve+=c*Qe,c=T[6],Fe+=c*$e,Ae+=c*Re,ye+=c*Me,pe+=c*je,fe+=c*ze,ue+=c*Ce,ce+=c*Ge,ae+=c*We,oe+=c*Ye,re+=c*ke,he+=c*Xe,ge+=c*qe,ne+=c*Be,we+=c*Ne,ve+=c*Je,Se+=c*Qe,c=T[7],Ae+=c*$e,ye+=c*Re,pe+=c*Me,fe+=c*je,ue+=c*ze,ce+=c*Ce,ae+=c*Ge,oe+=c*We,re+=c*Ye,he+=c*ke,ge+=c*Xe,ne+=c*qe,we+=c*Be,ve+=c*Ne,Se+=c*Je,De+=c*Qe,c=T[8],ye+=c*$e,pe+=c*Re,fe+=c*Me,ue+=c*je,ce+=c*ze,ae+=c*Ce,oe+=c*Ge,re+=c*We,he+=c*Ye,ge+=c*ke,ne+=c*Xe,we+=c*qe,ve+=c*Be,Se+=c*Ne,De+=c*Je,Ee+=c*Qe,c=T[9],pe+=c*$e,fe+=c*Re,ue+=c*Me,ce+=c*je,ae+=c*ze,oe+=c*Ce,re+=c*Ge,he+=c*We,ge+=c*Ye,ne+=c*ke,we+=c*Xe,ve+=c*qe,Se+=c*Be,De+=c*Ne,Ee+=c*Je,St+=c*Qe,c=T[10],fe+=c*$e,ue+=c*Re,ce+=c*Me,ae+=c*je,oe+=c*ze,re+=c*Ce,he+=c*Ge,ge+=c*We,ne+=c*Ye,we+=c*ke,ve+=c*Xe,Se+=c*qe,De+=c*Be,Ee+=c*Ne,St+=c*Je,Tt+=c*Qe,c=T[11],ue+=c*$e,ce+=c*Re,ae+=c*Me,oe+=c*je,re+=c*ze,he+=c*Ce,ge+=c*Ge,ne+=c*We,we+=c*Ye,ve+=c*ke,Se+=c*Xe,De+=c*qe,Ee+=c*Be,St+=c*Ne,Tt+=c*Je,$t+=c*Qe,c=T[12],ce+=c*$e,ae+=c*Re,oe+=c*Me,re+=c*je,he+=c*ze,ge+=c*Ce,ne+=c*Ge,we+=c*We,ve+=c*Ye,Se+=c*ke,De+=c*Xe,Ee+=c*qe,St+=c*Be,Tt+=c*Ne,$t+=c*Je,gt+=c*Qe,c=T[13],ae+=c*$e,oe+=c*Re,re+=c*Me,he+=c*je,ge+=c*ze,ne+=c*Ce,we+=c*Ge,ve+=c*We,Se+=c*Ye,De+=c*ke,Ee+=c*Xe,St+=c*qe,Tt+=c*Be,$t+=c*Ne,gt+=c*Je,Jt+=c*Qe,c=T[14],oe+=c*$e,re+=c*Re,he+=c*Me,ge+=c*je,ne+=c*ze,we+=c*Ce,ve+=c*Ge,Se+=c*We,De+=c*Ye,Ee+=c*ke,St+=c*Xe,Tt+=c*qe,$t+=c*Be,gt+=c*Ne,Jt+=c*Je,$r+=c*Qe,c=T[15],re+=c*$e,he+=c*Re,ge+=c*Me,ne+=c*je,we+=c*ze,ve+=c*Ce,Se+=c*Ge,De+=c*We,Ee+=c*Ye,St+=c*ke,Tt+=c*Xe,$t+=c*qe,gt+=c*Be,Jt+=c*Ne,$r+=c*Je,li+=c*Qe,H+=38*he,Y+=38*ge,le+=38*ne,be+=38*we,de+=38*ve,me+=38*Se,Fe+=38*De,Ae+=38*Ee,ye+=38*St,pe+=38*Tt,fe+=38*$t,ue+=38*gt,ce+=38*Jt,ae+=38*$r,oe+=38*li,b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=Y+b+65535,b=Math.floor(c/65536),Y=c-b*65536,c=le+b+65535,b=Math.floor(c/65536),le=c-b*65536,c=be+b+65535,b=Math.floor(c/65536),be=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,c=Ae+b+65535,b=Math.floor(c/65536),Ae=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,c=pe+b+65535,b=Math.floor(c/65536),pe=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=ce+b+65535,b=Math.floor(c/65536),ce=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,H+=b-1+37*(b-1),b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=Y+b+65535,b=Math.floor(c/65536),Y=c-b*65536,c=le+b+65535,b=Math.floor(c/65536),le=c-b*65536,c=be+b+65535,b=Math.floor(c/65536),be=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,c=Ae+b+65535,b=Math.floor(c/65536),Ae=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,c=pe+b+65535,b=Math.floor(c/65536),pe=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=ce+b+65535,b=Math.floor(c/65536),ce=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,H+=b-1+37*(b-1),N[0]=H,N[1]=Y,N[2]=le,N[3]=be,N[4]=de,N[5]=me,N[6]=Fe,N[7]=Ae,N[8]=ye,N[9]=pe,N[10]=fe,N[11]=ue,N[12]=ce,N[13]=ae,N[14]=oe,N[15]=re}function f(N,T){o(N,T,T)}function C(N,T){const D=n();let c;for(c=0;c<16;c++)D[c]=T[c];for(c=253;c>=0;c--)f(D,D),c!==2&&c!==4&&o(D,D,T);for(c=0;c<16;c++)N[c]=D[c]}function L(N,T){const D=n();let c;for(c=0;c<16;c++)D[c]=T[c];for(c=250;c>=0;c--)f(D,D),c!==1&&o(D,D,T);for(c=0;c<16;c++)N[c]=D[c]}function K(N,T){const D=n(),c=n(),b=n(),H=n(),Y=n(),le=n(),be=n(),de=n(),me=n();d(D,N[1],N[0]),d(me,T[1],T[0]),o(D,D,me),w(c,N[0],N[1]),w(me,T[0],T[1]),o(c,c,me),o(b,N[3],T[3]),o(b,b,h),o(H,N[2],T[2]),w(H,H,H),d(Y,c,D),d(le,H,b),w(be,H,b),w(de,c,D),o(N[0],Y,le),o(N[1],de,be),o(N[2],be,le),o(N[3],Y,de)}function G(N,T,D){for(let c=0;c<4;c++)A(N[c],T[c],D)}function J(N,T){const D=n(),c=n(),b=n();C(b,T[2]),o(D,T[0],b),o(c,T[1],b),R(N,c),N[31]^=I(D)<<7}function x(N,T,D){m(N[0],a),m(N[1],u),m(N[2],u),m(N[3],a);for(let c=255;c>=0;--c){const b=D[c/8|0]>>(c&7)&1;G(N,T,b),K(T,N),K(N,N),G(N,T,b)}}function P(N,T){const D=[n(),n(),n(),n()];m(D[0],p),m(D[1],v),m(D[2],u),o(D[3],p,v),x(N,D,T)}function W(N){if(N.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(32),c=[n(),n(),n(),n()];P(c,T),J(D,c);const b=new Uint8Array(64);return b.set(N),b.set(D,32),{publicKey:D,secretKey:b}}t.generateKeyPairFromSeed=W;function j(N){const T=(0,e.randomBytes)(32,N),D=W(T);return(0,i.wipe)(T),D}t.generateKeyPair=j;function U(N){if(N.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}t.extractPublicKeyFromSecretKey=U;const M=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function F(N,T){let D,c,b,H;for(c=63;c>=32;--c){for(D=0,b=c-32,H=c-12;b<H;++b)T[b]+=D-16*T[c]*M[b-(c-32)],D=Math.floor((T[b]+128)/256),T[b]-=D*256;T[b]+=D,T[c]=0}for(D=0,b=0;b<32;b++)T[b]+=D-(T[31]>>4)*M[b],D=T[b]>>8,T[b]&=255;for(b=0;b<32;b++)T[b]-=D*M[b];for(c=0;c<32;c++)T[c+1]+=T[c]>>8,N[c]=T[c]&255}function z(N){const T=new Float64Array(64);for(let D=0;D<64;D++)T[D]=N[D];for(let D=0;D<64;D++)N[D]=0;F(N,T)}function te(N,T){const D=new Float64Array(64),c=[n(),n(),n(),n()],b=(0,r.hash)(N.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const H=new Uint8Array(64);H.set(b.subarray(32),32);const Y=new r.SHA512;Y.update(H.subarray(32)),Y.update(T);const le=Y.digest();Y.clean(),z(le),P(c,le),J(H,c),Y.reset(),Y.update(H.subarray(0,32)),Y.update(N.subarray(32)),Y.update(T);const be=Y.digest();z(be);for(let de=0;de<32;de++)D[de]=le[de];for(let de=0;de<32;de++)for(let me=0;me<32;me++)D[de+me]+=be[de]*b[me];return F(H.subarray(32),D),H}t.sign=te;function B(N,T){const D=n(),c=n(),b=n(),H=n(),Y=n(),le=n(),be=n();return m(N[2],u),y(N[1],T),f(b,N[1]),o(H,b,l),d(b,b,N[2]),w(H,N[2],H),f(Y,H),f(le,Y),o(be,le,Y),o(D,be,b),o(D,D,H),L(D,D),o(D,D,b),o(D,D,H),o(D,D,H),o(N[0],D,H),f(c,N[0]),o(c,c,H),E(c,b)&&o(N[0],N[0],_),f(c,N[0]),o(c,c,H),E(c,b)?-1:(I(N[0])===T[31]>>7&&d(N[0],a,N[0]),o(N[3],N[0],N[1]),0)}function Z(N,T,D){const c=new Uint8Array(32),b=[n(),n(),n(),n()],H=[n(),n(),n(),n()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(B(H,N))return!1;const Y=new r.SHA512;Y.update(D.subarray(0,32)),Y.update(N),Y.update(T);const le=Y.digest();return z(le),x(b,H,le),P(H,D.subarray(32)),K(b,H),J(c,b),!q(D,c)}t.verify=Z;function k(N){let T=[n(),n(),n(),n()];if(B(T,N))throw new Error("Ed25519: invalid public key");let D=n(),c=n(),b=T[1];w(D,u,b),d(c,u,b),C(c,c),o(D,D,c);let H=new Uint8Array(32);return R(H,D),H}t.convertPublicKeyToX25519=k;function ee(N){const T=(0,r.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(T.subarray(0,32));return(0,i.wipe)(T),D}t.convertSecretKeyToX25519=ee}(zi);const Kh="EdDSA",Hh="JWT",As=".",Rs="base64url",Vh="utf8",Gh="utf8",Wh=":",Yh="did",kh="key",Cs="base58btc",Xh="z",Jh="K36",Qh=32;function Ls(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Vi(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Ls(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Zh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var u=t.length,l=t.charAt(0),h=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function v(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var A=0,R=0,q=0,E=S.length;q!==E&&S[q]===0;)q++,A++;for(var I=(E-q)*p+1>>>0,y=new Uint8Array(I);q!==E;){for(var w=S[q],d=0,o=I-1;(w!==0||d<R)&&o!==-1;o--,d++)w+=256*y[o]>>>0,y[o]=w%u>>>0,w=w/u>>>0;if(w!==0)throw new Error("Non-zero carry");R=d,q++}for(var f=I-R;f!==I&&y[f]===0;)f++;for(var C=l.repeat(A);f<I;++f)C+=t.charAt(y[f]);return C}function _(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var A=0;if(S[A]!==" "){for(var R=0,q=0;S[A]===l;)R++,A++;for(var E=(S.length-A)*h+1>>>0,I=new Uint8Array(E);S[A];){var y=r[S.charCodeAt(A)];if(y===255)return;for(var w=0,d=E-1;(y!==0||w<q)&&d!==-1;d--,w++)y+=u*I[d]>>>0,I[d]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");q=w,A++}if(S[A]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(R+(E-o)),C=R;o!==E;)f[C++]=I[o++];return f}}}function m(S){var A=_(S);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:v,decodeUnsafe:_,decode:m}}var el=Zh,tl=el;const Fs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},rl=t=>new TextEncoder().encode(t),il=t=>new TextDecoder().decode(t);class nl{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sl{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Us(this,e)}}class ol{constructor(e){this.decoders=e}or(e){return Us(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Us=(t,e)=>new ol({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class al{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new nl(e,r,i),this.decoder=new sl(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xr=({name:t,prefix:e,encode:r,decode:i})=>new al(t,e,r,i),Sr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=tl(r,e);return Xr({prefix:t,name:e,encode:i,decode:s=>Fs(n(s))})},cl=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let u=0,l=0,h=0;for(let p=0;p<s;++p){const v=n[t[p]];if(v===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|v,u+=r,u>=8&&(u-=8,a[h++]=255&l>>u)}if(u>=r||255&l<<8-u)throw new SyntaxError("Unexpected end of data");return a},ul=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,u=0;for(let l=0;l<t.length;++l)for(u=u<<8|t[l],a+=8;a>r;)a-=r,s+=e[n&u>>a];if(a&&(s+=e[n&u<<r-a]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Xr({prefix:e,name:t,encode(n){return ul(n,i,r)},decode(n){return cl(n,i,r,t)}}),hl=Xr({prefix:"\0",name:"identity",encode:t=>il(t),decode:t=>rl(t)});var ll=Object.freeze({__proto__:null,identity:hl});const fl=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var dl=Object.freeze({__proto__:null,base2:fl});const pl=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gl=Object.freeze({__proto__:null,base8:pl});const yl=Sr({prefix:"9",name:"base10",alphabet:"0123456789"});var _l=Object.freeze({__proto__:null,base10:yl});const bl=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wl=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var vl=Object.freeze({__proto__:null,base16:bl,base16upper:wl});const ml=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),El=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sl=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Dl=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ol=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),xl=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Il=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tl=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Nl=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Pl=Object.freeze({__proto__:null,base32:ml,base32upper:El,base32pad:Sl,base32padupper:Dl,base32hex:Ol,base32hexupper:xl,base32hexpad:Il,base32hexpadupper:Tl,base32z:Nl});const Al=Sr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Rl=Sr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Cl=Object.freeze({__proto__:null,base36:Al,base36upper:Rl});const Ll=Sr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fl=Sr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ul=Object.freeze({__proto__:null,base58btc:Ll,base58flickr:Fl});const $l=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ml=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jl=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zl=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Bl=Object.freeze({__proto__:null,base64:$l,base64pad:Ml,base64url:jl,base64urlpad:zl});const $s=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ql=$s.reduce((t,e,r)=>(t[r]=e,t),[]),Kl=$s.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Hl(t){return t.reduce((e,r)=>(e+=ql[r],e),"")}function Vl(t){const e=[];for(const r of t){const i=Kl[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Gl=Xr({prefix:"\u{1F680}",name:"base256emoji",encode:Hl,decode:Vl});var Wl=Object.freeze({__proto__:null,base256emoji:Gl}),Yl=js,Ms=128,kl=127,Xl=~kl,Jl=Math.pow(2,31);function js(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Jl;)e[r++]=t&255|Ms,t/=128;for(;t&Xl;)e[r++]=t&255|Ms,t>>>=7;return e[r]=t|0,js.bytes=r-i+1,e}var Ql=Gi,Zl=128,zs=127;function Gi(t,i){var r=0,i=i||0,n=0,s=i,a,u=t.length;do{if(s>=u)throw Gi.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&zs)<<n:(a&zs)*Math.pow(2,n),n+=7}while(a>=Zl);return Gi.bytes=s-i,r}var ef=Math.pow(2,7),tf=Math.pow(2,14),rf=Math.pow(2,21),nf=Math.pow(2,28),sf=Math.pow(2,35),of=Math.pow(2,42),af=Math.pow(2,49),cf=Math.pow(2,56),uf=Math.pow(2,63),hf=function(t){return t<ef?1:t<tf?2:t<rf?3:t<nf?4:t<sf?5:t<of?6:t<af?7:t<cf?8:t<uf?9:10},lf={encode:Yl,decode:Ql,encodingLength:hf},Bs=lf;const qs=(t,e,r=0)=>(Bs.encode(t,e,r),e),Ks=t=>Bs.encodingLength(t),Wi=(t,e)=>{const r=e.byteLength,i=Ks(t),n=i+Ks(r),s=new Uint8Array(n+r);return qs(t,s,0),qs(r,s,i),s.set(e,n),new ff(t,r,e,s)};class ff{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Hs=({name:t,code:e,encode:r})=>new df(t,e,r);class df{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Wi(this.code,r):r.then(i=>Wi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Vs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),pf=Hs({name:"sha2-256",code:18,encode:Vs("SHA-256")}),gf=Hs({name:"sha2-512",code:19,encode:Vs("SHA-512")});var yf=Object.freeze({__proto__:null,sha256:pf,sha512:gf});const Gs=0,_f="identity",Ws=Fs;var bf=Object.freeze({__proto__:null,identity:{code:Gs,name:_f,encode:Ws,digest:t=>Wi(Gs,Ws(t))}});new TextEncoder,new TextDecoder;const Ys={...ll,...dl,...gl,..._l,...vl,...Pl,...Cl,...Ul,...Bl,...Wl};({...yf,...bf});function ks(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Xs=ks("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Yi=ks("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ls(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Js={utf8:Xs,"utf-8":Xs,hex:Ys.base16,latin1:Yi,ascii:Yi,binary:Yi,...Ys};function at(t,e="utf8"){const r=Js[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ft(t,e="utf8"){const r=Js[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Jr(t){return at(ft(ji(t),Vh),Rs)}function Qs(t){const e=ft(Jh,Cs),r=Xh+at(Vi([e,t]),Cs);return[Yh,kh,r].join(Wh)}function wf(t){return at(t,Rs)}function vf(t){return ft([Jr(t.header),Jr(t.payload)].join(As),Gh)}function mf(t){return[Jr(t.header),Jr(t.payload),wf(t.signature)].join(As)}function Zs(t=nr.randomBytes(Qh)){return zi.generateKeyPairFromSeed(t)}async function Ef(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:Kh,typ:Hh},a=Qs(i.publicKey),u=n+r,l={iss:a,sub:t,aud:e,iat:n,exp:u},h=vf({header:s,payload:l}),p=zi.sign(i.secretKey,h);return mf({header:s,payload:l,signature:p})}var ki={},Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});var nt=ie,Xi=pt,Sf=20;function Df(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,a=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],p=r[15]<<24|r[14]<<16|r[13]<<8|r[12],v=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],S=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],R=e[7]<<24|e[6]<<16|e[5]<<8|e[4],q=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=i,y=n,w=s,d=a,o=u,f=l,C=h,L=p,K=v,G=_,J=m,x=S,P=A,W=R,j=q,U=E,M=0;M<Sf;M+=2)I=I+o|0,P^=I,P=P>>>32-16|P<<16,K=K+P|0,o^=K,o=o>>>32-12|o<<12,y=y+f|0,W^=y,W=W>>>32-16|W<<16,G=G+W|0,f^=G,f=f>>>32-12|f<<12,w=w+C|0,j^=w,j=j>>>32-16|j<<16,J=J+j|0,C^=J,C=C>>>32-12|C<<12,d=d+L|0,U^=d,U=U>>>32-16|U<<16,x=x+U|0,L^=x,L=L>>>32-12|L<<12,w=w+C|0,j^=w,j=j>>>32-8|j<<8,J=J+j|0,C^=J,C=C>>>32-7|C<<7,d=d+L|0,U^=d,U=U>>>32-8|U<<8,x=x+U|0,L^=x,L=L>>>32-7|L<<7,y=y+f|0,W^=y,W=W>>>32-8|W<<8,G=G+W|0,f^=G,f=f>>>32-7|f<<7,I=I+o|0,P^=I,P=P>>>32-8|P<<8,K=K+P|0,o^=K,o=o>>>32-7|o<<7,I=I+f|0,U^=I,U=U>>>32-16|U<<16,J=J+U|0,f^=J,f=f>>>32-12|f<<12,y=y+C|0,P^=y,P=P>>>32-16|P<<16,x=x+P|0,C^=x,C=C>>>32-12|C<<12,w=w+L|0,W^=w,W=W>>>32-16|W<<16,K=K+W|0,L^=K,L=L>>>32-12|L<<12,d=d+o|0,j^=d,j=j>>>32-16|j<<16,G=G+j|0,o^=G,o=o>>>32-12|o<<12,w=w+L|0,W^=w,W=W>>>32-8|W<<8,K=K+W|0,L^=K,L=L>>>32-7|L<<7,d=d+o|0,j^=d,j=j>>>32-8|j<<8,G=G+j|0,o^=G,o=o>>>32-7|o<<7,y=y+C|0,P^=y,P=P>>>32-8|P<<8,x=x+P|0,C^=x,C=C>>>32-7|C<<7,I=I+f|0,U^=I,U=U>>>32-8|U<<8,J=J+U|0,f^=J,f=f>>>32-7|f<<7;nt.writeUint32LE(I+i|0,t,0),nt.writeUint32LE(y+n|0,t,4),nt.writeUint32LE(w+s|0,t,8),nt.writeUint32LE(d+a|0,t,12),nt.writeUint32LE(o+u|0,t,16),nt.writeUint32LE(f+l|0,t,20),nt.writeUint32LE(C+h|0,t,24),nt.writeUint32LE(L+p|0,t,28),nt.writeUint32LE(K+v|0,t,32),nt.writeUint32LE(G+_|0,t,36),nt.writeUint32LE(J+m|0,t,40),nt.writeUint32LE(x+S|0,t,44),nt.writeUint32LE(P+A|0,t,48),nt.writeUint32LE(W+R|0,t,52),nt.writeUint32LE(j+q|0,t,56),nt.writeUint32LE(U+E|0,t,60)}function eo(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=n}for(var u=new Uint8Array(64),l=0;l<r.length;l+=64){Df(u,s,t);for(var h=l;h<l+64&&h<r.length;h++)i[h]=r[h]^u[h-l];xf(s,0,a)}return Xi.wipe(u),n===0&&Xi.wipe(s),i}Qr.streamXOR=eo;function Of(t,e,r,i){return i===void 0&&(i=0),Xi.wipe(r),eo(t,e,r,r,i)}Qr.stream=Of;function xf(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var to={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});function If(t,e,r){return~(t-1)&e|t-1&r}Lt.select=If;function Tf(t,e){return(t|0)-(e|0)-1>>>31&1}Lt.lessOrEqual=Tf;function ro(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Lt.compare=ro;function Nf(t,e){return t.length===0||e.length===0?!1:ro(t,e)!==0}Lt.equal=Nf,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Lt,r=pt;t.DIGEST_LENGTH=16;var i=function(){function a(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=u[0]|u[1]<<8;this._r[0]=l&8191;var h=u[2]|u[3]<<8;this._r[1]=(l>>>13|h<<3)&8191;var p=u[4]|u[5]<<8;this._r[2]=(h>>>10|p<<6)&7939;var v=u[6]|u[7]<<8;this._r[3]=(p>>>7|v<<9)&8191;var _=u[8]|u[9]<<8;this._r[4]=(v>>>4|_<<12)&255,this._r[5]=_>>>1&8190;var m=u[10]|u[11]<<8;this._r[6]=(_>>>14|m<<2)&8191;var S=u[12]|u[13]<<8;this._r[7]=(m>>>11|S<<5)&8065;var A=u[14]|u[15]<<8;this._r[8]=(S>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return a.prototype._blocks=function(u,l,h){for(var p=this._fin?0:2048,v=this._h[0],_=this._h[1],m=this._h[2],S=this._h[3],A=this._h[4],R=this._h[5],q=this._h[6],E=this._h[7],I=this._h[8],y=this._h[9],w=this._r[0],d=this._r[1],o=this._r[2],f=this._r[3],C=this._r[4],L=this._r[5],K=this._r[6],G=this._r[7],J=this._r[8],x=this._r[9];h>=16;){var P=u[l+0]|u[l+1]<<8;v+=P&8191;var W=u[l+2]|u[l+3]<<8;_+=(P>>>13|W<<3)&8191;var j=u[l+4]|u[l+5]<<8;m+=(W>>>10|j<<6)&8191;var U=u[l+6]|u[l+7]<<8;S+=(j>>>7|U<<9)&8191;var M=u[l+8]|u[l+9]<<8;A+=(U>>>4|M<<12)&8191,R+=M>>>1&8191;var F=u[l+10]|u[l+11]<<8;q+=(M>>>14|F<<2)&8191;var z=u[l+12]|u[l+13]<<8;E+=(F>>>11|z<<5)&8191;var te=u[l+14]|u[l+15]<<8;I+=(z>>>8|te<<8)&8191,y+=te>>>5|p;var B=0,Z=B;Z+=v*w,Z+=_*(5*x),Z+=m*(5*J),Z+=S*(5*G),Z+=A*(5*K),B=Z>>>13,Z&=8191,Z+=R*(5*L),Z+=q*(5*C),Z+=E*(5*f),Z+=I*(5*o),Z+=y*(5*d),B+=Z>>>13,Z&=8191;var k=B;k+=v*d,k+=_*w,k+=m*(5*x),k+=S*(5*J),k+=A*(5*G),B=k>>>13,k&=8191,k+=R*(5*K),k+=q*(5*L),k+=E*(5*C),k+=I*(5*f),k+=y*(5*o),B+=k>>>13,k&=8191;var ee=B;ee+=v*o,ee+=_*d,ee+=m*w,ee+=S*(5*x),ee+=A*(5*J),B=ee>>>13,ee&=8191,ee+=R*(5*G),ee+=q*(5*K),ee+=E*(5*L),ee+=I*(5*C),ee+=y*(5*f),B+=ee>>>13,ee&=8191;var N=B;N+=v*f,N+=_*o,N+=m*d,N+=S*w,N+=A*(5*x),B=N>>>13,N&=8191,N+=R*(5*J),N+=q*(5*G),N+=E*(5*K),N+=I*(5*L),N+=y*(5*C),B+=N>>>13,N&=8191;var T=B;T+=v*C,T+=_*f,T+=m*o,T+=S*d,T+=A*w,B=T>>>13,T&=8191,T+=R*(5*x),T+=q*(5*J),T+=E*(5*G),T+=I*(5*K),T+=y*(5*L),B+=T>>>13,T&=8191;var D=B;D+=v*L,D+=_*C,D+=m*f,D+=S*o,D+=A*d,B=D>>>13,D&=8191,D+=R*w,D+=q*(5*x),D+=E*(5*J),D+=I*(5*G),D+=y*(5*K),B+=D>>>13,D&=8191;var c=B;c+=v*K,c+=_*L,c+=m*C,c+=S*f,c+=A*o,B=c>>>13,c&=8191,c+=R*d,c+=q*w,c+=E*(5*x),c+=I*(5*J),c+=y*(5*G),B+=c>>>13,c&=8191;var b=B;b+=v*G,b+=_*K,b+=m*L,b+=S*C,b+=A*f,B=b>>>13,b&=8191,b+=R*o,b+=q*d,b+=E*w,b+=I*(5*x),b+=y*(5*J),B+=b>>>13,b&=8191;var H=B;H+=v*J,H+=_*G,H+=m*K,H+=S*L,H+=A*C,B=H>>>13,H&=8191,H+=R*f,H+=q*o,H+=E*d,H+=I*w,H+=y*(5*x),B+=H>>>13,H&=8191;var Y=B;Y+=v*x,Y+=_*J,Y+=m*G,Y+=S*K,Y+=A*L,B=Y>>>13,Y&=8191,Y+=R*C,Y+=q*f,Y+=E*o,Y+=I*d,Y+=y*w,B+=Y>>>13,Y&=8191,B=(B<<2)+B|0,B=B+Z|0,Z=B&8191,B=B>>>13,k+=B,v=Z,_=k,m=ee,S=N,A=T,R=D,q=c,E=b,I=H,y=Y,l+=16,h-=16}this._h[0]=v,this._h[1]=_,this._h[2]=m,this._h[3]=S,this._h[4]=A,this._h[5]=R,this._h[6]=q,this._h[7]=E,this._h[8]=I,this._h[9]=y},a.prototype.finish=function(u,l){l===void 0&&(l=0);var h=new Uint16Array(10),p,v,_,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(p=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=p,p=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=p*5,p=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=p,p=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=p,h[0]=this._h[0]+5,p=h[0]>>>13,h[0]&=8191,m=1;m<10;m++)h[m]=this._h[m]+p,p=h[m]>>>13,h[m]&=8191;for(h[9]-=1<<13,v=(p^1)-1,m=0;m<10;m++)h[m]&=v;for(v=~v,m=0;m<10;m++)this._h[m]=this._h[m]&v|h[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,_=this._h[0]+this._pad[0],this._h[0]=_&65535,m=1;m<8;m++)_=(this._h[m]+this._pad[m]|0)+(_>>>16)|0,this._h[m]=_&65535;return u[l+0]=this._h[0]>>>0,u[l+1]=this._h[0]>>>8,u[l+2]=this._h[1]>>>0,u[l+3]=this._h[1]>>>8,u[l+4]=this._h[2]>>>0,u[l+5]=this._h[2]>>>8,u[l+6]=this._h[3]>>>0,u[l+7]=this._h[3]>>>8,u[l+8]=this._h[4]>>>0,u[l+9]=this._h[4]>>>8,u[l+10]=this._h[5]>>>0,u[l+11]=this._h[5]>>>8,u[l+12]=this._h[6]>>>0,u[l+13]=this._h[6]>>>8,u[l+14]=this._h[7]>>>0,u[l+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(u){var l=0,h=u.length,p;if(this._leftover){p=16-this._leftover,p>h&&(p=h);for(var v=0;v<p;v++)this._buffer[this._leftover+v]=u[l+v];if(h-=p,l+=p,this._leftover+=p,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(p=h-h%16,this._blocks(u,l,p),l+=p,h-=p),h){for(var v=0;v<h;v++)this._buffer[this._leftover+v]=u[l+v];this._leftover+=h}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=i;function n(a,u){var l=new i(a);l.update(u);var h=l.digest();return l.clean(),h}t.oneTimeAuth=n;function s(a,u){return a.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(a,u)}t.equal=s}(to),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Qr,r=to,i=pt,n=ie,s=Lt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),u=function(){function l(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return l.prototype.seal=function(h,p,v,_){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(h,m.length-h.length);var S=new Uint8Array(32);e.stream(this._key,m,S,4);var A=p.length+this.tagLength,R;if(_){if(_.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");R=_}else R=new Uint8Array(A);return e.streamXOR(this._key,m,p,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),S,R.subarray(0,R.length-this.tagLength),v),i.wipe(m),R},l.prototype.open=function(h,p,v,_){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(p.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(h,m.length-h.length);var S=new Uint8Array(32);e.stream(this._key,m,S,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,S,p.subarray(0,p.length-this.tagLength),v),!s.equal(A,p.subarray(p.length-this.tagLength,p.length)))return null;var R=p.length-this.tagLength,q;if(_){if(_.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");q=_}else q=new Uint8Array(R);return e.streamXOR(this._key,m,p.subarray(0,p.length-this.tagLength),q,4),i.wipe(m),q},l.prototype.clean=function(){return i.wipe(this._key),this},l.prototype._authenticate=function(h,p,v,_){var m=new r.Poly1305(p);_&&(m.update(_),_.length%16>0&&m.update(a.subarray(_.length%16))),m.update(v),v.length%16>0&&m.update(a.subarray(v.length%16));var S=new Uint8Array(8);_&&n.writeUint64LE(_.length,S),m.update(S),n.writeUint64LE(v.length,S),m.update(S);for(var A=m.digest(),R=0;R<A.length;R++)h[R]=A[R];m.clean(),i.wipe(A),i.wipe(S)},l}();t.ChaCha20Poly1305=u}(ki);var io={},Dr={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});function Pf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Ji.isSerializableHash=Pf,Object.defineProperty(Dr,"__esModule",{value:!0});var Ot=Ji,Af=Lt,Rf=pt,no=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Ot.isSerializableHash(this._inner)&&Ot.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Rf.wipe(i)}return t.prototype.reset=function(){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ot.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ot.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Dr.HMAC=no;function Cf(t,e,r){var i=new no(t,e);i.update(r);var n=i.digest();return i.clean(),n}Dr.hmac=Cf,Dr.equal=Af.equal,Object.defineProperty(io,"__esModule",{value:!0});var so=Dr,oo=pt,Lf=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=so.hmac(this._hash,i,r);this._hmac=new so.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),oo.wipe(this._buffer),oo.wipe(this._counter),this._bufpos=0},t}(),Ff=io.HKDF=Lf,Zr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var p=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=l[p++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(p=s(this._temp,this._state,l,p,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[p++],h--;return this},u.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,p=this._bufferLength,v=h/536870912|0,_=h<<3,m=h%64<56?64:128;this._buffer[p]=128;for(var S=p+1;S<m-8;S++)this._buffer[S]=0;e.writeUint32BE(v,this._buffer,m-8),e.writeUint32BE(_,this._buffer,m-4),s(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],l,S*4);return this},u.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},u}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,l,h,p,v){for(;v>=64;){for(var _=l[0],m=l[1],S=l[2],A=l[3],R=l[4],q=l[5],E=l[6],I=l[7],y=0;y<16;y++){var w=p+y*4;u[y]=e.readUint32BE(h,w)}for(var y=16;y<64;y++){var d=u[y-2],o=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=u[y-15];var f=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;u[y]=(o+u[y-7]|0)+(f+u[y-16]|0)}for(var y=0;y<64;y++){var o=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&q^~R&E)|0)+(I+(n[y]+u[y]|0)|0)|0,f=((_>>>2|_<<32-2)^(_>>>13|_<<32-13)^(_>>>22|_<<32-22))+(_&m^_&S^m&S)|0;I=E,E=q,q=R,R=A+o|0,A=S,S=m,m=_,_=o+f|0}l[0]+=_,l[1]+=m,l[2]+=S,l[3]+=A,l[4]+=R,l[5]+=q,l[6]+=E,l[7]+=I,p+=64,v-=64}return p}function a(u){var l=new i;l.update(u);var h=l.digest();return l.clean(),h}t.hash=a})(Zr);var Qi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=nr,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(y){const w=new Float64Array(16);if(y)for(let d=0;d<y.length;d++)w[d]=y[d];return w}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function a(y){let w=1;for(let d=0;d<16;d++){let o=y[d]+w+65535;w=Math.floor(o/65536),y[d]=o-w*65536}y[0]+=w-1+37*(w-1)}function u(y,w,d){const o=~(d-1);for(let f=0;f<16;f++){const C=o&(y[f]^w[f]);y[f]^=C,w[f]^=C}}function l(y,w){const d=i(),o=i();for(let f=0;f<16;f++)o[f]=w[f];a(o),a(o),a(o);for(let f=0;f<2;f++){d[0]=o[0]-65517;for(let L=1;L<15;L++)d[L]=o[L]-65535-(d[L-1]>>16&1),d[L-1]&=65535;d[15]=o[15]-32767-(d[14]>>16&1);const C=d[15]>>16&1;d[14]&=65535,u(o,d,1-C)}for(let f=0;f<16;f++)y[2*f]=o[f]&255,y[2*f+1]=o[f]>>8}function h(y,w){for(let d=0;d<16;d++)y[d]=w[2*d]+(w[2*d+1]<<8);y[15]&=32767}function p(y,w,d){for(let o=0;o<16;o++)y[o]=w[o]+d[o]}function v(y,w,d){for(let o=0;o<16;o++)y[o]=w[o]-d[o]}function _(y,w,d){let o,f,C=0,L=0,K=0,G=0,J=0,x=0,P=0,W=0,j=0,U=0,M=0,F=0,z=0,te=0,B=0,Z=0,k=0,ee=0,N=0,T=0,D=0,c=0,b=0,H=0,Y=0,le=0,be=0,de=0,me=0,Fe=0,Ae=0,ye=d[0],pe=d[1],fe=d[2],ue=d[3],ce=d[4],ae=d[5],oe=d[6],re=d[7],he=d[8],ge=d[9],ne=d[10],we=d[11],ve=d[12],Se=d[13],De=d[14],Ee=d[15];o=w[0],C+=o*ye,L+=o*pe,K+=o*fe,G+=o*ue,J+=o*ce,x+=o*ae,P+=o*oe,W+=o*re,j+=o*he,U+=o*ge,M+=o*ne,F+=o*we,z+=o*ve,te+=o*Se,B+=o*De,Z+=o*Ee,o=w[1],L+=o*ye,K+=o*pe,G+=o*fe,J+=o*ue,x+=o*ce,P+=o*ae,W+=o*oe,j+=o*re,U+=o*he,M+=o*ge,F+=o*ne,z+=o*we,te+=o*ve,B+=o*Se,Z+=o*De,k+=o*Ee,o=w[2],K+=o*ye,G+=o*pe,J+=o*fe,x+=o*ue,P+=o*ce,W+=o*ae,j+=o*oe,U+=o*re,M+=o*he,F+=o*ge,z+=o*ne,te+=o*we,B+=o*ve,Z+=o*Se,k+=o*De,ee+=o*Ee,o=w[3],G+=o*ye,J+=o*pe,x+=o*fe,P+=o*ue,W+=o*ce,j+=o*ae,U+=o*oe,M+=o*re,F+=o*he,z+=o*ge,te+=o*ne,B+=o*we,Z+=o*ve,k+=o*Se,ee+=o*De,N+=o*Ee,o=w[4],J+=o*ye,x+=o*pe,P+=o*fe,W+=o*ue,j+=o*ce,U+=o*ae,M+=o*oe,F+=o*re,z+=o*he,te+=o*ge,B+=o*ne,Z+=o*we,k+=o*ve,ee+=o*Se,N+=o*De,T+=o*Ee,o=w[5],x+=o*ye,P+=o*pe,W+=o*fe,j+=o*ue,U+=o*ce,M+=o*ae,F+=o*oe,z+=o*re,te+=o*he,B+=o*ge,Z+=o*ne,k+=o*we,ee+=o*ve,N+=o*Se,T+=o*De,D+=o*Ee,o=w[6],P+=o*ye,W+=o*pe,j+=o*fe,U+=o*ue,M+=o*ce,F+=o*ae,z+=o*oe,te+=o*re,B+=o*he,Z+=o*ge,k+=o*ne,ee+=o*we,N+=o*ve,T+=o*Se,D+=o*De,c+=o*Ee,o=w[7],W+=o*ye,j+=o*pe,U+=o*fe,M+=o*ue,F+=o*ce,z+=o*ae,te+=o*oe,B+=o*re,Z+=o*he,k+=o*ge,ee+=o*ne,N+=o*we,T+=o*ve,D+=o*Se,c+=o*De,b+=o*Ee,o=w[8],j+=o*ye,U+=o*pe,M+=o*fe,F+=o*ue,z+=o*ce,te+=o*ae,B+=o*oe,Z+=o*re,k+=o*he,ee+=o*ge,N+=o*ne,T+=o*we,D+=o*ve,c+=o*Se,b+=o*De,H+=o*Ee,o=w[9],U+=o*ye,M+=o*pe,F+=o*fe,z+=o*ue,te+=o*ce,B+=o*ae,Z+=o*oe,k+=o*re,ee+=o*he,N+=o*ge,T+=o*ne,D+=o*we,c+=o*ve,b+=o*Se,H+=o*De,Y+=o*Ee,o=w[10],M+=o*ye,F+=o*pe,z+=o*fe,te+=o*ue,B+=o*ce,Z+=o*ae,k+=o*oe,ee+=o*re,N+=o*he,T+=o*ge,D+=o*ne,c+=o*we,b+=o*ve,H+=o*Se,Y+=o*De,le+=o*Ee,o=w[11],F+=o*ye,z+=o*pe,te+=o*fe,B+=o*ue,Z+=o*ce,k+=o*ae,ee+=o*oe,N+=o*re,T+=o*he,D+=o*ge,c+=o*ne,b+=o*we,H+=o*ve,Y+=o*Se,le+=o*De,be+=o*Ee,o=w[12],z+=o*ye,te+=o*pe,B+=o*fe,Z+=o*ue,k+=o*ce,ee+=o*ae,N+=o*oe,T+=o*re,D+=o*he,c+=o*ge,b+=o*ne,H+=o*we,Y+=o*ve,le+=o*Se,be+=o*De,de+=o*Ee,o=w[13],te+=o*ye,B+=o*pe,Z+=o*fe,k+=o*ue,ee+=o*ce,N+=o*ae,T+=o*oe,D+=o*re,c+=o*he,b+=o*ge,H+=o*ne,Y+=o*we,le+=o*ve,be+=o*Se,de+=o*De,me+=o*Ee,o=w[14],B+=o*ye,Z+=o*pe,k+=o*fe,ee+=o*ue,N+=o*ce,T+=o*ae,D+=o*oe,c+=o*re,b+=o*he,H+=o*ge,Y+=o*ne,le+=o*we,be+=o*ve,de+=o*Se,me+=o*De,Fe+=o*Ee,o=w[15],Z+=o*ye,k+=o*pe,ee+=o*fe,N+=o*ue,T+=o*ce,D+=o*ae,c+=o*oe,b+=o*re,H+=o*he,Y+=o*ge,le+=o*ne,be+=o*we,de+=o*ve,me+=o*Se,Fe+=o*De,Ae+=o*Ee,C+=38*k,L+=38*ee,K+=38*N,G+=38*T,J+=38*D,x+=38*c,P+=38*b,W+=38*H,j+=38*Y,U+=38*le,M+=38*be,F+=38*de,z+=38*me,te+=38*Fe,B+=38*Ae,f=1,o=C+f+65535,f=Math.floor(o/65536),C=o-f*65536,o=L+f+65535,f=Math.floor(o/65536),L=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=J+f+65535,f=Math.floor(o/65536),J=o-f*65536,o=x+f+65535,f=Math.floor(o/65536),x=o-f*65536,o=P+f+65535,f=Math.floor(o/65536),P=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=z+f+65535,f=Math.floor(o/65536),z=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,C+=f-1+37*(f-1),f=1,o=C+f+65535,f=Math.floor(o/65536),C=o-f*65536,o=L+f+65535,f=Math.floor(o/65536),L=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=J+f+65535,f=Math.floor(o/65536),J=o-f*65536,o=x+f+65535,f=Math.floor(o/65536),x=o-f*65536,o=P+f+65535,f=Math.floor(o/65536),P=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=z+f+65535,f=Math.floor(o/65536),z=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,C+=f-1+37*(f-1),y[0]=C,y[1]=L,y[2]=K,y[3]=G,y[4]=J,y[5]=x,y[6]=P,y[7]=W,y[8]=j,y[9]=U,y[10]=M,y[11]=F,y[12]=z,y[13]=te,y[14]=B,y[15]=Z}function m(y,w){_(y,w,w)}function S(y,w){const d=i();for(let o=0;o<16;o++)d[o]=w[o];for(let o=253;o>=0;o--)m(d,d),o!==2&&o!==4&&_(d,d,w);for(let o=0;o<16;o++)y[o]=d[o]}function A(y,w){const d=new Uint8Array(32),o=new Float64Array(80),f=i(),C=i(),L=i(),K=i(),G=i(),J=i();for(let j=0;j<31;j++)d[j]=y[j];d[31]=y[31]&127|64,d[0]&=248,h(o,w);for(let j=0;j<16;j++)C[j]=o[j];f[0]=K[0]=1;for(let j=254;j>=0;--j){const U=d[j>>>3]>>>(j&7)&1;u(f,C,U),u(L,K,U),p(G,f,L),v(f,f,L),p(L,C,K),v(C,C,K),m(K,G),m(J,f),_(f,L,f),_(L,C,G),p(G,f,L),v(f,f,L),m(C,f),v(L,K,J),_(f,L,s),p(f,f,K),_(L,L,f),_(f,K,J),_(K,C,o),m(C,G),u(f,C,U),u(L,K,U)}for(let j=0;j<16;j++)o[j+16]=f[j],o[j+32]=L[j],o[j+48]=C[j],o[j+64]=K[j];const x=o.subarray(32),P=o.subarray(16);S(x,x),_(P,P,x);const W=new Uint8Array(32);return l(W,P),W}t.scalarMult=A;function R(y){return A(y,n)}t.scalarMultBase=R;function q(y){if(y.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(y);return{publicKey:R(w),secretKey:w}}t.generateKeyPairFromSeed=q;function E(y){const w=(0,e.randomBytes)(32,y),d=q(w);return(0,r.wipe)(w),d}t.generateKeyPair=E;function I(y,w,d=!1){if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(y,w);if(d){let f=0;for(let C=0;C<o.length;C++)f|=o[C];if(f===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=I})(Qi);var ao=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Uf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),$f=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Mf=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),jf=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),zf=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Bf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,qf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,co=3,Kf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Bf]],uo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Hf(t){return t?ho(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new zf:typeof navigator<"u"?ho(navigator.userAgent):Wf()}function Vf(t){return t!==""&&Kf.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function ho(t){var e=Vf(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new jf;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<co&&(n=ao(ao([],n,!0),Yf(co-n.length),!0)):n=[];var s=n.join("."),a=Gf(t),u=qf.exec(t);return u&&u[1]?new Mf(r,s,a,u[1]):new Uf(r,s,a)}function Gf(t){for(var e=0,r=uo.length;e<r;e++){var i=uo[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function Wf(){var t=typeof process<"u"&&process.version;return t?new $f(process.version.slice(1)):null}function Yf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=fo=Ie.getLocation=Ie.getLocationOrThrow=Zi=Ie.getNavigator=Ie.getNavigatorOrThrow=lo=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Wt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=Wt;function sr(t){const e=Wt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=sr;function kf(){return sr("document")}Ie.getDocumentOrThrow=kf;function Xf(){return Wt("document")}var lo=Ie.getDocument=Xf;function Jf(){return sr("navigator")}Ie.getNavigatorOrThrow=Jf;function Qf(){return Wt("navigator")}var Zi=Ie.getNavigator=Qf;function Zf(){return sr("location")}Ie.getLocationOrThrow=Zf;function ed(){return Wt("location")}var fo=Ie.getLocation=ed;function td(){return sr("crypto")}Ie.getCryptoOrThrow=td;function rd(){return Wt("crypto")}Ie.getCrypto=rd;function id(){return sr("localStorage")}Ie.getLocalStorageOrThrow=id;function nd(){return Wt("localStorage")}Ie.getLocalStorage=nd;var en={};Object.defineProperty(en,"__esModule",{value:!0});var po=en.getWindowMetadata=void 0;const go=Ie;function sd(){let t,e;try{t=go.getDocumentOrThrow(),e=go.getLocationOrThrow()}catch{return null}function r(){const v=t.getElementsByTagName("link"),_=[];for(let m=0;m<v.length;m++){const S=v[m],A=S.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const R=S.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let q=e.protocol+"//"+e.host;if(R.indexOf("/")===0)q+=R;else{const E=e.pathname.split("/");E.pop();const I=E.join("/");q+=I+"/"+R}_.push(q)}else if(R.indexOf("//")===0){const q=e.protocol+R;_.push(q)}else _.push(R)}}return _}function i(...v){const _=t.getElementsByTagName("meta");for(let m=0;m<_.length;m++){const S=_[m],A=["itemprop","property","name"].map(R=>S.getAttribute(R)).filter(R=>R?v.includes(R):!1);if(A.length&&A){const R=S.getAttribute("content");if(R)return R}}return""}function n(){let v=i("name","og:site_name","og:title","twitter:title");return v||(v=t.title),v}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),u=s(),l=e.origin,h=r();return{description:u,url:l,icons:h,name:a}}po=en.getWindowMetadata=sd;var Or={},od=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),yo="%[a-f0-9]{2}",_o=new RegExp("("+yo+")|([^%]+?)","gi"),bo=new RegExp("("+yo+")+","gi");function tn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],tn(r),tn(i))}function ad(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(_o)||[],r=1;r<e.length;r++)t=tn(e,r).join(""),e=t.match(_o)||[];return t}}function cd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=bo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=ad(r[0]);i!==r[0]&&(e[r[0]]=i)}r=bo.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var a=n[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var ud=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return cd(t)}},hd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},ld=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var a=i[s],u=t[a];(n?e.indexOf(a)!==-1:e(a,u,t))&&(r[a]=u)}return r};(function(t){const e=od,r=ud,i=hd,n=ld,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function u(E){switch(E.arrayFormat){case"index":return I=>(y,w)=>{const d=y.length;return w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?y:w===null?[...y,[p(I,E),"[",d,"]"].join("")]:[...y,[p(I,E),"[",p(d,E),"]=",p(w,E)].join("")]};case"bracket":return I=>(y,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?y:w===null?[...y,[p(I,E),"[]"].join("")]:[...y,[p(I,E),"[]=",p(w,E)].join("")];case"colon-list-separator":return I=>(y,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?y:w===null?[...y,[p(I,E),":list="].join("")]:[...y,[p(I,E),":list=",p(w,E)].join("")];case"comma":case"separator":case"bracket-separator":{const I=E.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(w,d)=>d===void 0||E.skipNull&&d===null||E.skipEmptyString&&d===""?w:(d=d===null?"":d,w.length===0?[[p(y,E),I,p(d,E)].join("")]:[[w,p(d,E)].join(E.arrayFormatSeparator)])}default:return I=>(y,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?y:w===null?[...y,p(I,E)]:[...y,[p(I,E),"=",p(w,E)].join("")]}}function l(E){let I;switch(E.arrayFormat){case"index":return(y,w,d)=>{if(I=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!I){d[y]=w;return}d[y]===void 0&&(d[y]={}),d[y][I[1]]=w};case"bracket":return(y,w,d)=>{if(I=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!I){d[y]=w;return}if(d[y]===void 0){d[y]=[w];return}d[y]=[].concat(d[y],w)};case"colon-list-separator":return(y,w,d)=>{if(I=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!I){d[y]=w;return}if(d[y]===void 0){d[y]=[w];return}d[y]=[].concat(d[y],w)};case"comma":case"separator":return(y,w,d)=>{const o=typeof w=="string"&&w.includes(E.arrayFormatSeparator),f=typeof w=="string"&&!o&&v(w,E).includes(E.arrayFormatSeparator);w=f?v(w,E):w;const C=o||f?w.split(E.arrayFormatSeparator).map(L=>v(L,E)):w===null?w:v(w,E);d[y]=C};case"bracket-separator":return(y,w,d)=>{const o=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!o){d[y]=w&&v(w,E);return}const f=w===null?[]:w.split(E.arrayFormatSeparator).map(C=>v(C,E));if(d[y]===void 0){d[y]=f;return}d[y]=[].concat(d[y],f)};default:return(y,w,d)=>{if(d[y]===void 0){d[y]=w;return}d[y]=[].concat(d[y],w)}}}function h(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function p(E,I){return I.encode?I.strict?e(E):encodeURIComponent(E):E}function v(E,I){return I.decode?r(E):E}function _(E){return Array.isArray(E)?E.sort():typeof E=="object"?_(Object.keys(E)).sort((I,y)=>Number(I)-Number(y)).map(I=>E[I]):E}function m(E){const I=E.indexOf("#");return I!==-1&&(E=E.slice(0,I)),E}function S(E){let I="";const y=E.indexOf("#");return y!==-1&&(I=E.slice(y)),I}function A(E){E=m(E);const I=E.indexOf("?");return I===-1?"":E.slice(I+1)}function R(E,I){return I.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):I.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function q(E,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),h(I.arrayFormatSeparator);const y=l(I),w=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return w;for(const d of E.split("&")){if(d==="")continue;let[o,f]=i(I.decode?d.replace(/\+/g," "):d,"=");f=f===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?f:v(f,I),y(v(o,I),f,w)}for(const d of Object.keys(w)){const o=w[d];if(typeof o=="object"&&o!==null)for(const f of Object.keys(o))o[f]=R(o[f],I);else w[d]=R(o,I)}return I.sort===!1?w:(I.sort===!0?Object.keys(w).sort():Object.keys(w).sort(I.sort)).reduce((d,o)=>{const f=w[o];return Boolean(f)&&typeof f=="object"&&!Array.isArray(f)?d[o]=_(f):d[o]=f,d},Object.create(null))}t.extract=A,t.parse=q,t.stringify=(E,I)=>{if(!E)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),h(I.arrayFormatSeparator);const y=f=>I.skipNull&&s(E[f])||I.skipEmptyString&&E[f]==="",w=u(I),d={};for(const f of Object.keys(E))y(f)||(d[f]=E[f]);const o=Object.keys(d);return I.sort!==!1&&o.sort(I.sort),o.map(f=>{const C=E[f];return C===void 0?"":C===null?p(f,I):Array.isArray(C)?C.length===0&&I.arrayFormat==="bracket-separator"?p(f,I)+"[]":C.reduce(w(f),[]).join("&"):p(f,I)+"="+p(C,I)}).filter(f=>f.length>0).join("&")},t.parseUrl=(E,I)=>{I=Object.assign({decode:!0},I);const[y,w]=i(E,"#");return Object.assign({url:y.split("?")[0]||"",query:q(A(E),I)},I&&I.parseFragmentIdentifier&&w?{fragmentIdentifier:v(w,I)}:{})},t.stringifyUrl=(E,I)=>{I=Object.assign({encode:!0,strict:!0,[a]:!0},I);const y=m(E.url).split("?")[0]||"",w=t.extract(E.url),d=t.parse(w,{sort:!1}),o=Object.assign(d,E.query);let f=t.stringify(o,I);f&&(f=`?${f}`);let C=S(E.url);return E.fragmentIdentifier&&(C=`#${I[a]?p(E.fragmentIdentifier,I):E.fragmentIdentifier}`),`${y}${f}${C}`},t.pick=(E,I,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[a]:!1},y);const{url:w,query:d,fragmentIdentifier:o}=t.parseUrl(E,y);return t.stringifyUrl({url:w,query:n(d,I),fragmentIdentifier:o},y)},t.exclude=(E,I,y)=>{const w=Array.isArray(I)?d=>!I.includes(d):(d,o)=>!I(d,o);return t.pick(E,w,y)}})(Or);const fd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function wo(t,e){return t.includes(":")?[t]:e.chains||[]}const vo="base10",ct="base16",rn="base64pad",nn="utf8",mo=0,Yt=1,dd=0,Eo=1,sn=12,on=32;function pd(){const t=Qi.generateKeyPair();return{privateKey:at(t.secretKey,ct),publicKey:at(t.publicKey,ct)}}function an(){const t=nr.randomBytes(on);return at(t,ct)}function gd(t,e){const r=Qi.sharedKey(ft(t,ct),ft(e,ct)),i=new Ff(Zr.SHA256,r).expand(on);return at(i,ct)}function yd(t){const e=Zr.hash(ft(t,ct));return at(e,ct)}function kt(t){const e=Zr.hash(ft(t,nn));return at(e,ct)}function _d(t){return ft(`${t}`,vo)}function xr(t){return Number(at(t,vo))}function bd(t){const e=_d(typeof t.type<"u"?t.type:mo);if(xr(e)===Yt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ft(t.senderPublicKey,ct):void 0,i=typeof t.iv<"u"?ft(t.iv,ct):nr.randomBytes(sn),n=new ki.ChaCha20Poly1305(ft(t.symKey,ct)).seal(i,ft(t.message,nn));return vd({type:e,sealed:n,iv:i,senderPublicKey:r})}function wd(t){const e=new ki.ChaCha20Poly1305(ft(t.symKey,ct)),{sealed:r,iv:i}=ei(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return at(n,nn)}function vd(t){if(xr(t.type)===Yt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(Vi([t.type,t.senderPublicKey,t.iv,t.sealed]),rn)}return at(Vi([t.type,t.iv,t.sealed]),rn)}function ei(t){const e=ft(t,rn),r=e.slice(dd,Eo),i=Eo;if(xr(r)===Yt){const u=i+on,l=u+sn,h=e.slice(i,u),p=e.slice(u,l),v=e.slice(l);return{type:r,sealed:v,iv:p,senderPublicKey:h}}const n=i+sn,s=e.slice(i,n),a=e.slice(n);return{type:r,sealed:a,iv:s}}function md(t,e){const r=ei(t);return So({type:xr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ct):void 0,receiverPublicKey:e?.receiverPublicKey})}function So(t){const e=t?.type||mo;if(e===Yt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Do(t){return t.type===Yt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Ed=Object.defineProperty,Oo=Object.getOwnPropertySymbols,Sd=Object.prototype.hasOwnProperty,Dd=Object.prototype.propertyIsEnumerable,xo=(t,e,r)=>e in t?Ed(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Io=(t,e)=>{for(var r in e||(e={}))Sd.call(e,r)&&xo(t,r,e[r]);if(Oo)for(var r of Oo(e))Dd.call(e,r)&&xo(t,r,e[r]);return t};const Od="ReactNative",Ir={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},xd="js";function cn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Id(){return!lo()&&!!Zi()&&navigator.product===Od}function un(){return!cn()&&!!Zi()}function Td(){return Id()?Ir.reactNative:cn()?Ir.node:un()?Ir.browser:Ir.unknown}function Nd(t,e){let r=Or.parse(t);return r=Io(Io({},r),e),t=Or.stringify(r),t}function Pd(){return po()||{name:"",description:"",url:"",icons:[""]}}function Ad(){const t=Hf();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Rd(){var t;const e=Td();return e===Ir.browser?[e,((t=fo())==null?void 0:t.host)||"unknown"].join(":"):e}function Cd(t,e,r){const i=Ad(),n=Rd();return[[t,e].join("-"),[xd,r].join("-"),i,n].join("/")}function Ld({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a}){const u=r.split("?"),l=Cd(t,e,i),h={auth:n,ua:l,projectId:s,useOnCloseEvent:a||void 0},p=Nd(u[1]||"",h);return u[0]+"?"+p}function Xt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function To(t){return Object.fromEntries(t.entries())}function No(t){return new Map(Object.entries(t))}function or(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,u)=>{s=setTimeout(()=>{u(new Error(e))},r),i=a,n=u})}}function ti(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function Po(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Fd(t){return Po("topic",t)}function Ud(t){return Po("id",t)}function Ao(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function mt(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function Ft(t){return Date.now()>=Q.toMiliseconds(t)}function Ue(t,e){return`${t}${e?`:${e}`:""}`}const $d="irn";function hn(t){return t?.relay||{protocol:$d}}function ri(t){const e=fd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Md=Object.defineProperty,Ro=Object.getOwnPropertySymbols,jd=Object.prototype.hasOwnProperty,zd=Object.prototype.propertyIsEnumerable,Co=(t,e,r)=>e in t?Md(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bd=(t,e)=>{for(var r in e||(e={}))jd.call(e,r)&&Co(t,r,e[r]);if(Ro)for(var r of Ro(e))zd.call(e,r)&&Co(t,r,e[r]);return t};function qd(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function Kd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Or.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:a.symKey,relay:qd(a)}}function Hd(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Vd(t){return`${t.protocol}:${t.topic}@${t.version}?`+Or.stringify(Bd({symKey:t.symKey},Hd(t.relay)))}function ar(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Gd(t){const e=[];return Object.values(t).forEach(r=>{e.push(...ar(r.accounts))}),e}function Wd(t,e){const r=[];return Object.values(t).forEach(i=>{ar(i.accounts).includes(e)&&r.push(...i.methods)}),r}function Yd(t,e){const r=[];return Object.values(t).forEach(i=>{ar(i.accounts).includes(e)&&r.push(...i.events)}),r}function kd(t,e){const r=ii(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return i}const Xd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Jd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=Jd[t];return{message:e?`${r} ${e}`:r,code:i}}function Ke(t,e){const{message:r,code:i}=Xd[t];return{message:e?`${r} ${e}`:r,code:i}}function Tr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Nr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ut(t){return typeof t>"u"}function He(t,e){return e&&ut(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function ln(t,e){return e&&ut(t)?!0:typeof t=="number"&&!isNaN(t)}function Qd(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Xt(n,i)?(i.forEach(a=>{const{accounts:u,methods:l,events:h}=t.namespaces[a],p=ar(u),v=r[a];(!Xt(wo(a,v),p)||!Xt(v.methods,l)||!Xt(v.events,h))&&(s=!1)}),s):!1}function fn(t){return He(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Zd(t){if(He(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&fn(r)}}return!1}function ep(t){if(He(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function tp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function rp(t){return t?.topic}function ip(t,e){let r=null;return He(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Lo(t){let e=!0;return Tr(t)?t.length&&(e=t.every(r=>He(r,!1))):e=!1,e}function np(t,e,r){let i=null;return Tr(e)?e.forEach(n=>{i||(!fn(n)||!n.includes(t))&&(i=Ke("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=Ke("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function sp(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=np(i,wo(i,n),`${e} requiredNamespace`);s&&(r=s)}),r}function op(t,e){let r=null;return Tr(t)?t.forEach(i=>{r||Zd(i)||(r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function ap(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=op(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function cp(t,e){let r=null;return Lo(t?.methods)?Lo(t?.events)||(r=Ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Fo(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=cp(i,`${e}, namespace`);n&&(r=n)}),r}function up(t,e,r){let i=null;if(t&&Nr(t)){const n=Fo(t,e);n&&(i=n);const s=sp(t,e);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function ii(t,e){let r=null;if(t&&Nr(t)){const i=Fo(t,e);i&&(r=i);const n=ap(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Uo(t){return He(t.protocol,!0)}function hp(t,e){let r=!1;return e&&!t?r=!0:t&&Tr(t)&&t.length&&t.forEach(i=>{r=Uo(i)}),r}function lp(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function fp(t){return!(!t||typeof t!="object"||!t.code||!ln(t.code,!1)||!t.message||!He(t.message,!1))}function dp(t){return!(ut(t)||!He(t.method,!1))}function pp(t){return!(ut(t)||ut(t.result)&&ut(t.error)||!ln(t.id,!1)||!He(t.jsonrpc,!1))}function gp(t){return!(ut(t)||!He(t.name,!1))}function $o(t,e){return!(!fn(e)||!Gd(t).includes(e))}function yp(t,e,r){return He(r,!1)?Wd(t,e).includes(r):!1}function _p(t,e,r){return He(r,!1)?Yd(t,e).includes(r):!1}function Mo(t,e,r){let i=null;const n=bp(t),s=wp(e),a=Object.keys(n),u=Object.keys(s),l=jo(Object.keys(t)),h=jo(Object.keys(e)),p=l.filter(v=>!h.includes(v));return p.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${p.toString()}
      Received: ${Object.keys(e).toString()}`)),Xt(a,u)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${u.toString()}`)),Object.keys(e).forEach(v=>{if(!v.includes(":")||i)return;const _=ar(e[v].accounts);_.includes(v)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${v}
        Required: ${v}
        Approved: ${_.toString()}`))}),a.forEach(v=>{i||(Xt(n[v].methods,s[v].methods)?Xt(n[v].events,s[v].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${v}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${v}`))}),i}function bp(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function jo(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function wp(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=ar(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function vp(t,e){return ln(t,!1)&&t<=e.max&&t>=e.min}const mp="PARSE_ERROR",Ep="INVALID_REQUEST",Sp="METHOD_NOT_FOUND",Dp="INVALID_PARAMS",zo="INTERNAL_ERROR",dn="SERVER_ERROR",Op=[-32700,-32600,-32601,-32602,-32603],Pr={[mp]:{code:-32700,message:"Parse error"},[Ep]:{code:-32600,message:"Invalid Request"},[Sp]:{code:-32601,message:"Method not found"},[Dp]:{code:-32602,message:"Invalid params"},[zo]:{code:-32603,message:"Internal error"},[dn]:{code:-32e3,message:"Server error"}},Bo=dn;function xp(t){return Op.includes(t)}function qo(t){return Object.keys(Pr).includes(t)?Pr[t]:Pr[Bo]}function Ip(t){const e=Object.values(Pr).find(r=>r.code===t);return e||Pr[Bo]}function Tp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ko={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var pn=function(t,e){return pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},pn(t,e)};function Np(t,e){pn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var gn=function(){return gn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},gn.apply(this,arguments)};function Pp(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ap(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Rp(t,e){return function(r,i){e(r,i,t)}}function Cp(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Lp(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{h(i.next(p))}catch(v){a(v)}}function l(p){try{h(i.throw(p))}catch(v){a(v)}}function h(p){p.done?s(p.value):n(p.value).then(u,l)}h((i=i.apply(t,e||[])).next())})}function Fp(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(h){return function(p){return l([h,p])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Up(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function $p(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function yn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ho(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Mp(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ho(arguments[e]));return t}function jp(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}function zp(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(_){i[_]&&(n[_]=function(m){return new Promise(function(S,A){s.push([_,m,S,A])>1||u(_,m)})})}function u(_,m){try{l(i[_](m))}catch(S){v(s[0][3],S)}}function l(_){_.value instanceof Ar?Promise.resolve(_.value.v).then(h,p):v(s[0][2],_)}function h(_){u("next",_)}function p(_){u("throw",_)}function v(_,m){_(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Bp(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Ar(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function qp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof yn=="function"?yn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,l){a=t[s](a),n(u,l,a.done,a.value)})}}function n(s,a,u,l){Promise.resolve(l).then(function(h){s({value:h,done:u})},a)}}function Kp(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Hp(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Vp(t){return t&&t.__esModule?t:{default:t}}function Gp(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Wp(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Yp=Object.freeze({__proto__:null,__extends:Np,get __assign(){return gn},__rest:Pp,__decorate:Ap,__param:Rp,__metadata:Cp,__awaiter:Lp,__generator:Fp,__createBinding:Up,__exportStar:$p,__values:yn,__read:Ho,__spread:Mp,__spreadArrays:jp,__await:Ar,__asyncGenerator:zp,__asyncDelegator:Bp,__asyncValues:qp,__makeTemplateObject:Kp,__importStar:Hp,__importDefault:Vp,__classPrivateFieldGet:Gp,__classPrivateFieldSet:Wp}),kp=Bt(Yp),Nt={},Vo;function Xp(){if(Vo)return Nt;Vo=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowserCryptoAvailable=Nt.getSubtleCrypto=Nt.getBrowerCrypto=void 0;function t(){return et?.crypto||et?.msCrypto||{}}Nt.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Nt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Nt.isBrowserCryptoAvailable=r,Nt}var Pt={},Go;function Jp(){if(Go)return Pt;Go=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isBrowser=Pt.isNode=Pt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Pt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Pt.isNode=e;function r(){return!t()&&!e()}return Pt.isBrowser=r,Pt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kp;e.__exportStar(Xp(),t),e.__exportStar(Jp(),t)})(Ko);function Wo(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Qp(t=6){return BigInt(Wo(t))}function ni(t,e,r){return{id:r||Wo(),jsonrpc:"2.0",method:t,params:e}}function _n(t,e){return{id:t,jsonrpc:"2.0",result:e}}function bn(t,e,r){return{id:t,jsonrpc:"2.0",error:Zp(e,r)}}function Zp(t,e){return typeof t>"u"?qo(zo):(typeof t=="string"&&(t=Object.assign(Object.assign({},qo(dn)),{message:t})),typeof e<"u"&&(t.data=e),xp(t.code)&&(t=Ip(t.code)),t)}class eg{}class tg extends eg{constructor(){super()}}class rg extends tg{constructor(e){super()}}const ig="^wss?:";function ng(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function sg(t,e){const r=ng(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Yo(t){return sg(t,ig)}function og(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ko(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function wn(t){return ko(t)&&"method"in t}function vn(t){return ko(t)&&(At(t)||Et(t))}function At(t){return"result"in t}function Et(t){return"error"in t}class ag extends rg{constructor(e){super(e),this.events=new lt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ni(e.method,e.params||[],Qp().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Et(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),vn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Xo=10,cg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),ug=()=>typeof window<"u",hg=cg();class lg{constructor(e){if(this.url=e,this.events=new lt.exports.EventEmitter,this.registering=!1,!Yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ji(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Ko.isReactNative()?void 0:{rejectUnauthorized:!og(e)},s=new hg(e,[],n);ug()?s.onerror=a=>{const u=a;i(this.emitError(u.error))}:s.on("error",a=>{i(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Es(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=bn(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Tp(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Xo&&this.events.setMaxListeners(Xo)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var mn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,u="[object Arguments]",l="[object Array]",h="[object AsyncFunction]",p="[object Boolean]",v="[object Date]",_="[object Error]",m="[object Function]",S="[object GeneratorFunction]",A="[object Map]",R="[object Number]",q="[object Null]",E="[object Object]",I="[object Promise]",y="[object Proxy]",w="[object RegExp]",d="[object Set]",o="[object String]",f="[object Symbol]",C="[object Undefined]",L="[object WeakMap]",K="[object ArrayBuffer]",G="[object DataView]",J="[object Float32Array]",x="[object Float64Array]",P="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",U="[object Uint8Array]",M="[object Uint8ClampedArray]",F="[object Uint16Array]",z="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,k={};k[J]=k[x]=k[P]=k[W]=k[j]=k[U]=k[M]=k[F]=k[z]=!0,k[u]=k[l]=k[K]=k[p]=k[G]=k[v]=k[_]=k[m]=k[A]=k[R]=k[E]=k[w]=k[d]=k[o]=k[L]=!1;var ee=typeof et=="object"&&et&&et.Object===Object&&et,N=typeof self=="object"&&self&&self.Object===Object&&self,T=ee||N||Function("return this")(),D=e&&!e.nodeType&&e,c=D&&!0&&t&&!t.nodeType&&t,b=c&&c.exports===D,H=b&&ee.process,Y=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),le=Y&&Y.isTypedArray;function be(g,O){for(var $=-1,X=g==null?0:g.length,Te=0,se=[];++$<X;){var Le=g[$];O(Le,$,g)&&(se[Te++]=Le)}return se}function de(g,O){for(var $=-1,X=O.length,Te=g.length;++$<X;)g[Te+$]=O[$];return g}function me(g,O){for(var $=-1,X=g==null?0:g.length;++$<X;)if(O(g[$],$,g))return!0;return!1}function Fe(g,O){for(var $=-1,X=Array(g);++$<g;)X[$]=O($);return X}function Ae(g){return function(O){return g(O)}}function ye(g,O){return g.has(O)}function pe(g,O){return g?.[O]}function fe(g){var O=-1,$=Array(g.size);return g.forEach(function(X,Te){$[++O]=[Te,X]}),$}function ue(g,O){return function($){return g(O($))}}function ce(g){var O=-1,$=Array(g.size);return g.forEach(function(X){$[++O]=X}),$}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,he=T["__core-js_shared__"],ge=oe.toString,ne=re.hasOwnProperty,we=function(){var g=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),ve=re.toString,Se=RegExp("^"+ge.call(ne).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=b?T.Buffer:void 0,Ee=T.Symbol,St=T.Uint8Array,Tt=re.propertyIsEnumerable,$t=ae.splice,gt=Ee?Ee.toStringTag:void 0,Jt=Object.getOwnPropertySymbols,$r=De?De.isBuffer:void 0,li=ue(Object.keys,Object),$e=ur(T,"DataView"),Re=ur(T,"Map"),Me=ur(T,"Promise"),je=ur(T,"Set"),ze=ur(T,"WeakMap"),Ce=ur(Object,"create"),Ge=Zt($e),We=Zt(Re),Ye=Zt(Me),ke=Zt(je),Xe=Zt(ze),qe=Ee?Ee.prototype:void 0,Be=qe?qe.valueOf:void 0;function Ne(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function Je(){this.__data__=Ce?Ce(null):{},this.size=0}function Qe(g){var O=this.has(g)&&delete this.__data__[g];return this.size-=O?1:0,O}function Zy(g){var O=this.__data__;if(Ce){var $=O[g];return $===i?void 0:$}return ne.call(O,g)?O[g]:void 0}function e_(g){var O=this.__data__;return Ce?O[g]!==void 0:ne.call(O,g)}function t_(g,O){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=Ce&&O===void 0?i:O,this}Ne.prototype.clear=Je,Ne.prototype.delete=Qe,Ne.prototype.get=Zy,Ne.prototype.has=e_,Ne.prototype.set=t_;function Rt(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function r_(){this.__data__=[],this.size=0}function i_(g){var O=this.__data__,$=di(O,g);if($<0)return!1;var X=O.length-1;return $==X?O.pop():$t.call(O,$,1),--this.size,!0}function n_(g){var O=this.__data__,$=di(O,g);return $<0?void 0:O[$][1]}function s_(g){return di(this.__data__,g)>-1}function o_(g,O){var $=this.__data__,X=di($,g);return X<0?(++this.size,$.push([g,O])):$[X][1]=O,this}Rt.prototype.clear=r_,Rt.prototype.delete=i_,Rt.prototype.get=n_,Rt.prototype.has=s_,Rt.prototype.set=o_;function Qt(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function a_(){this.size=0,this.__data__={hash:new Ne,map:new(Re||Rt),string:new Ne}}function c_(g){var O=pi(this,g).delete(g);return this.size-=O?1:0,O}function u_(g){return pi(this,g).get(g)}function h_(g){return pi(this,g).has(g)}function l_(g,O){var $=pi(this,g),X=$.size;return $.set(g,O),this.size+=$.size==X?0:1,this}Qt.prototype.clear=a_,Qt.prototype.delete=c_,Qt.prototype.get=u_,Qt.prototype.has=h_,Qt.prototype.set=l_;function fi(g){var O=-1,$=g==null?0:g.length;for(this.__data__=new Qt;++O<$;)this.add(g[O])}function f_(g){return this.__data__.set(g,i),this}function d_(g){return this.__data__.has(g)}fi.prototype.add=fi.prototype.push=f_,fi.prototype.has=d_;function Mt(g){var O=this.__data__=new Rt(g);this.size=O.size}function p_(){this.__data__=new Rt,this.size=0}function g_(g){var O=this.__data__,$=O.delete(g);return this.size=O.size,$}function y_(g){return this.__data__.get(g)}function __(g){return this.__data__.has(g)}function b_(g,O){var $=this.__data__;if($ instanceof Rt){var X=$.__data__;if(!Re||X.length<r-1)return X.push([g,O]),this.size=++$.size,this;$=this.__data__=new Qt(X)}return $.set(g,O),this.size=$.size,this}Mt.prototype.clear=p_,Mt.prototype.delete=g_,Mt.prototype.get=y_,Mt.prototype.has=__,Mt.prototype.set=b_;function w_(g,O){var $=gi(g),X=!$&&L_(g),Te=!$&&!X&&Rn(g),se=!$&&!X&&!Te&&Wa(g),Le=$||X||Te||se,Ze=Le?Fe(g.length,String):[],it=Ze.length;for(var Pe in g)(O||ne.call(g,Pe))&&!(Le&&(Pe=="length"||Te&&(Pe=="offset"||Pe=="parent")||se&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||N_(Pe,it)))&&Ze.push(Pe);return Ze}function di(g,O){for(var $=g.length;$--;)if(Ka(g[$][0],O))return $;return-1}function v_(g,O,$){var X=O(g);return gi(g)?X:de(X,$(g))}function Mr(g){return g==null?g===void 0?C:q:gt&&gt in Object(g)?I_(g):C_(g)}function ja(g){return jr(g)&&Mr(g)==u}function za(g,O,$,X,Te){return g===O?!0:g==null||O==null||!jr(g)&&!jr(O)?g!==g&&O!==O:m_(g,O,$,X,za,Te)}function m_(g,O,$,X,Te,se){var Le=gi(g),Ze=gi(O),it=Le?l:jt(g),Pe=Ze?l:jt(O);it=it==u?E:it,Pe=Pe==u?E:Pe;var yt=it==E,Dt=Pe==E,st=it==Pe;if(st&&Rn(g)){if(!Rn(O))return!1;Le=!0,yt=!1}if(st&&!yt)return se||(se=new Mt),Le||Wa(g)?Ba(g,O,$,X,Te,se):O_(g,O,it,$,X,Te,se);if(!($&n)){var wt=yt&&ne.call(g,"__wrapped__"),vt=Dt&&ne.call(O,"__wrapped__");if(wt||vt){var zt=wt?g.value():g,Ct=vt?O.value():O;return se||(se=new Mt),Te(zt,Ct,$,X,se)}}return st?(se||(se=new Mt),x_(g,O,$,X,Te,se)):!1}function E_(g){if(!Ga(g)||A_(g))return!1;var O=Ha(g)?Se:B;return O.test(Zt(g))}function S_(g){return jr(g)&&Va(g.length)&&!!k[Mr(g)]}function D_(g){if(!R_(g))return li(g);var O=[];for(var $ in Object(g))ne.call(g,$)&&$!="constructor"&&O.push($);return O}function Ba(g,O,$,X,Te,se){var Le=$&n,Ze=g.length,it=O.length;if(Ze!=it&&!(Le&&it>Ze))return!1;var Pe=se.get(g);if(Pe&&se.get(O))return Pe==O;var yt=-1,Dt=!0,st=$&s?new fi:void 0;for(se.set(g,O),se.set(O,g);++yt<Ze;){var wt=g[yt],vt=O[yt];if(X)var zt=Le?X(vt,wt,yt,O,g,se):X(wt,vt,yt,g,O,se);if(zt!==void 0){if(zt)continue;Dt=!1;break}if(st){if(!me(O,function(Ct,er){if(!ye(st,er)&&(wt===Ct||Te(wt,Ct,$,X,se)))return st.push(er)})){Dt=!1;break}}else if(!(wt===vt||Te(wt,vt,$,X,se))){Dt=!1;break}}return se.delete(g),se.delete(O),Dt}function O_(g,O,$,X,Te,se,Le){switch($){case G:if(g.byteLength!=O.byteLength||g.byteOffset!=O.byteOffset)return!1;g=g.buffer,O=O.buffer;case K:return!(g.byteLength!=O.byteLength||!se(new St(g),new St(O)));case p:case v:case R:return Ka(+g,+O);case _:return g.name==O.name&&g.message==O.message;case w:case o:return g==O+"";case A:var Ze=fe;case d:var it=X&n;if(Ze||(Ze=ce),g.size!=O.size&&!it)return!1;var Pe=Le.get(g);if(Pe)return Pe==O;X|=s,Le.set(g,O);var yt=Ba(Ze(g),Ze(O),X,Te,se,Le);return Le.delete(g),yt;case f:if(Be)return Be.call(g)==Be.call(O)}return!1}function x_(g,O,$,X,Te,se){var Le=$&n,Ze=qa(g),it=Ze.length,Pe=qa(O),yt=Pe.length;if(it!=yt&&!Le)return!1;for(var Dt=it;Dt--;){var st=Ze[Dt];if(!(Le?st in O:ne.call(O,st)))return!1}var wt=se.get(g);if(wt&&se.get(O))return wt==O;var vt=!0;se.set(g,O),se.set(O,g);for(var zt=Le;++Dt<it;){st=Ze[Dt];var Ct=g[st],er=O[st];if(X)var Ya=Le?X(er,Ct,st,O,g,se):X(Ct,er,st,g,O,se);if(!(Ya===void 0?Ct===er||Te(Ct,er,$,X,se):Ya)){vt=!1;break}zt||(zt=st=="constructor")}if(vt&&!zt){var yi=g.constructor,_i=O.constructor;yi!=_i&&"constructor"in g&&"constructor"in O&&!(typeof yi=="function"&&yi instanceof yi&&typeof _i=="function"&&_i instanceof _i)&&(vt=!1)}return se.delete(g),se.delete(O),vt}function qa(g){return v_(g,$_,T_)}function pi(g,O){var $=g.__data__;return P_(O)?$[typeof O=="string"?"string":"hash"]:$.map}function ur(g,O){var $=pe(g,O);return E_($)?$:void 0}function I_(g){var O=ne.call(g,gt),$=g[gt];try{g[gt]=void 0;var X=!0}catch{}var Te=ve.call(g);return X&&(O?g[gt]=$:delete g[gt]),Te}var T_=Jt?function(g){return g==null?[]:(g=Object(g),be(Jt(g),function(O){return Tt.call(g,O)}))}:M_,jt=Mr;($e&&jt(new $e(new ArrayBuffer(1)))!=G||Re&&jt(new Re)!=A||Me&&jt(Me.resolve())!=I||je&&jt(new je)!=d||ze&&jt(new ze)!=L)&&(jt=function(g){var O=Mr(g),$=O==E?g.constructor:void 0,X=$?Zt($):"";if(X)switch(X){case Ge:return G;case We:return A;case Ye:return I;case ke:return d;case Xe:return L}return O});function N_(g,O){return O=O??a,!!O&&(typeof g=="number"||Z.test(g))&&g>-1&&g%1==0&&g<O}function P_(g){var O=typeof g;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?g!=="__proto__":g===null}function A_(g){return!!we&&we in g}function R_(g){var O=g&&g.constructor,$=typeof O=="function"&&O.prototype||re;return g===$}function C_(g){return ve.call(g)}function Zt(g){if(g!=null){try{return ge.call(g)}catch{}try{return g+""}catch{}}return""}function Ka(g,O){return g===O||g!==g&&O!==O}var L_=ja(function(){return arguments}())?ja:function(g){return jr(g)&&ne.call(g,"callee")&&!Tt.call(g,"callee")},gi=Array.isArray;function F_(g){return g!=null&&Va(g.length)&&!Ha(g)}var Rn=$r||j_;function U_(g,O){return za(g,O)}function Ha(g){if(!Ga(g))return!1;var O=Mr(g);return O==m||O==S||O==h||O==y}function Va(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=a}function Ga(g){var O=typeof g;return g!=null&&(O=="object"||O=="function")}function jr(g){return g!=null&&typeof g=="object"}var Wa=le?Ae(le):S_;function $_(g){return F_(g)?w_(g):D_(g)}function M_(){return[]}function j_(){return!1}t.exports=U_})(mn,mn.exports);var fg=mn.exports,dg=Object.defineProperty,Jo=Object.getOwnPropertySymbols,pg=Object.prototype.hasOwnProperty,gg=Object.prototype.propertyIsEnumerable,Qo=(t,e,r)=>e in t?dg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e)=>{for(var r in e||(e={}))pg.call(e,r)&&Qo(t,r,e[r]);if(Jo)for(var r of Jo(e))gg.call(e,r)&&Qo(t,r,e[r]);return t};function yg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var u=t.length,l=t.charAt(0),h=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function v(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var A=0,R=0,q=0,E=S.length;q!==E&&S[q]===0;)q++,A++;for(var I=(E-q)*p+1>>>0,y=new Uint8Array(I);q!==E;){for(var w=S[q],d=0,o=I-1;(w!==0||d<R)&&o!==-1;o--,d++)w+=256*y[o]>>>0,y[o]=w%u>>>0,w=w/u>>>0;if(w!==0)throw new Error("Non-zero carry");R=d,q++}for(var f=I-R;f!==I&&y[f]===0;)f++;for(var C=l.repeat(A);f<I;++f)C+=t.charAt(y[f]);return C}function _(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var A=0;if(S[A]!==" "){for(var R=0,q=0;S[A]===l;)R++,A++;for(var E=(S.length-A)*h+1>>>0,I=new Uint8Array(E);S[A];){var y=r[S.charCodeAt(A)];if(y===255)return;for(var w=0,d=E-1;(y!==0||w<q)&&d!==-1;d--,w++)y+=u*I[d]>>>0,I[d]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");q=w,A++}if(S[A]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(R+(E-o)),C=R;o!==E;)f[C++]=I[o++];return f}}}function m(S){var A=_(S);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:v,decodeUnsafe:_,decode:m}}var _g=yg,bg=_g;const Zo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},wg=t=>new TextEncoder().encode(t),vg=t=>new TextDecoder().decode(t);class mg{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Eg{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ea(this,e)}}class Sg{constructor(e){this.decoders=e}or(e){return ea(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ea=(t,e)=>new Sg(ht(ht({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Dg{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new mg(e,r,i),this.decoder=new Eg(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const si=({name:t,prefix:e,encode:r,decode:i})=>new Dg(t,e,r,i),Rr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=bg(r,e);return si({prefix:t,name:e,encode:i,decode:s=>Zo(n(s))})},Og=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let u=0,l=0,h=0;for(let p=0;p<s;++p){const v=n[t[p]];if(v===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|v,u+=r,u>=8&&(u-=8,a[h++]=255&l>>u)}if(u>=r||255&l<<8-u)throw new SyntaxError("Unexpected end of data");return a},xg=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,u=0;for(let l=0;l<t.length;++l)for(u=u<<8|t[l],a+=8;a>r;)a-=r,s+=e[n&u>>a];if(a&&(s+=e[n&u<<r-a]),i)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>si({prefix:e,name:t,encode(n){return xg(n,i,r)},decode(n){return Og(n,i,r,t)}}),Ig=si({prefix:"\0",name:"identity",encode:t=>vg(t),decode:t=>wg(t)});var Tg=Object.freeze({__proto__:null,identity:Ig});const Ng=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pg=Object.freeze({__proto__:null,base2:Ng});const Ag=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Rg=Object.freeze({__proto__:null,base8:Ag});const Cg=Rr({prefix:"9",name:"base10",alphabet:"0123456789"});var Lg=Object.freeze({__proto__:null,base10:Cg});const Fg=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ug=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $g=Object.freeze({__proto__:null,base16:Fg,base16upper:Ug});const Mg=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jg=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),zg=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bg=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qg=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kg=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hg=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vg=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Gg=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Wg=Object.freeze({__proto__:null,base32:Mg,base32upper:jg,base32pad:zg,base32padupper:Bg,base32hex:qg,base32hexupper:Kg,base32hexpad:Hg,base32hexpadupper:Vg,base32z:Gg});const Yg=Rr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kg=Rr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Xg=Object.freeze({__proto__:null,base36:Yg,base36upper:kg});const Jg=Rr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qg=Rr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Zg=Object.freeze({__proto__:null,base58btc:Jg,base58flickr:Qg});const e0=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),t0=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),r0=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),i0=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var n0=Object.freeze({__proto__:null,base64:e0,base64pad:t0,base64url:r0,base64urlpad:i0});const ta=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),s0=ta.reduce((t,e,r)=>(t[r]=e,t),[]),o0=ta.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function a0(t){return t.reduce((e,r)=>(e+=s0[r],e),"")}function c0(t){const e=[];for(const r of t){const i=o0[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const u0=si({prefix:"\u{1F680}",name:"base256emoji",encode:a0,decode:c0});var h0=Object.freeze({__proto__:null,base256emoji:u0}),l0=ia,ra=128,f0=127,d0=~f0,p0=Math.pow(2,31);function ia(t,e,r){e=e||[],r=r||0;for(var i=r;t>=p0;)e[r++]=t&255|ra,t/=128;for(;t&d0;)e[r++]=t&255|ra,t>>>=7;return e[r]=t|0,ia.bytes=r-i+1,e}var g0=En,y0=128,na=127;function En(t,i){var r=0,i=i||0,n=0,s=i,a,u=t.length;do{if(s>=u)throw En.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&na)<<n:(a&na)*Math.pow(2,n),n+=7}while(a>=y0);return En.bytes=s-i,r}var _0=Math.pow(2,7),b0=Math.pow(2,14),w0=Math.pow(2,21),v0=Math.pow(2,28),m0=Math.pow(2,35),E0=Math.pow(2,42),S0=Math.pow(2,49),D0=Math.pow(2,56),O0=Math.pow(2,63),x0=function(t){return t<_0?1:t<b0?2:t<w0?3:t<v0?4:t<m0?5:t<E0?6:t<S0?7:t<D0?8:t<O0?9:10},I0={encode:l0,decode:g0,encodingLength:x0},sa=I0;const oa=(t,e,r=0)=>(sa.encode(t,e,r),e),aa=t=>sa.encodingLength(t),Sn=(t,e)=>{const r=e.byteLength,i=aa(t),n=i+aa(r),s=new Uint8Array(n+r);return oa(t,s,0),oa(r,s,i),s.set(e,n),new T0(t,r,e,s)};class T0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const ca=({name:t,code:e,encode:r})=>new N0(t,e,r);class N0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Sn(this.code,r):r.then(i=>Sn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ua=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),P0=ca({name:"sha2-256",code:18,encode:ua("SHA-256")}),A0=ca({name:"sha2-512",code:19,encode:ua("SHA-512")});var R0=Object.freeze({__proto__:null,sha256:P0,sha512:A0});const ha=0,C0="identity",la=Zo;var L0=Object.freeze({__proto__:null,identity:{code:ha,name:C0,encode:la,digest:t=>Sn(ha,la(t))}});new TextEncoder,new TextDecoder;const fa=ht(ht(ht(ht(ht(ht(ht(ht(ht(ht({},Tg),Pg),Rg),Lg),$g),Wg),Xg),Zg),n0),h0);ht(ht({},R0),L0);function F0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function da(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const pa=da("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Dn=da("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=F0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),U0=ht({utf8:pa,"utf-8":pa,hex:fa.base16,latin1:Dn,ascii:Dn,binary:Dn},fa);function $0(t,e="utf8"){const r=U0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const ga="wc",M0=2,On="core",Ut=`${ga}@${2}:${On}:`,j0={name:On,logger:"error"},z0={database:":memory:"},B0="crypto",ya="client_ed25519_seed",q0=Q.ONE_DAY,K0="keychain",H0="0.3",V0="messages",G0="0.3",W0=Q.SIX_HOURS,Y0="publisher",_a="irn",k0="error",ba="wss://relay.walletconnect.com",X0="relayer",Ve={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},J0="_subscription",Cr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Q0=Q.ONE_SECOND,Z0="2.7.0",ey="0.3",xt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ty="subscription",ry="0.3",iy=Q.FIVE_SECONDS*1e3,ny="pairing",sy="0.3",Lr={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},oy="history",ay="0.3",cy="expirer",_t={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},uy="0.3",wa="verify-api",va="https://verify.walletconnect.com";class hy{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=K0,this.version=H0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,To(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?No(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ly{constructor(e,r,i){this.core=e,this.logger=r,this.name=B0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Zs(n);return Qs(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=pd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=Zs(s),u=an();return await Ef(u,n,q0,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const u=this.getPrivateKey(n),l=gd(u,s);return this.setSymKey(l,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||yd(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const u=So(a),l=ji(s);if(Do(u)){const _=u.senderPublicKey,m=u.receiverPublicKey;n=await this.generateSharedKey(_,m)}const h=this.getSymKey(n),{type:p,senderPublicKey:v}=u;return bd({type:p,symKey:h,message:l,senderPublicKey:v})},this.decode=async(n,s,a)=>{this.isInitialized();const u=md(s,a);if(Do(u)){const p=u.receiverPublicKey,v=u.senderPublicKey;n=await this.generateSharedKey(p,v)}const l=this.getSymKey(n),h=wd({symKey:l,encoded:s});return Es(h)},this.getPayloadType=n=>{const s=ei(n);return xr(s.type)},this.getPayloadSenderPublicKey=n=>{const s=ei(n);return s.senderPublicKey?at(s.senderPublicKey,ct):void 0},this.core=e,this.logger=_e.generateChildLogger(r,this.name),this.keychain=i||new hy(this.core,this.logger)}get context(){return _e.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ya)}catch{e=an(),await this.keychain.set(ya,e)}return $0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fy extends th{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=V0,this.version=G0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=kt(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=kt(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=_e.generateChildLogger(e,this.name),this.core=r}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,To(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?No(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class dy extends rh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new lt.exports.EventEmitter,this.name=Y0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const a=s?.ttl||W0,u=hn(s),l=s?.prompt||!1,h=s?.tag||0,p={topic:i,message:n,opts:{ttl:a,relay:u,prompt:l,tag:h}},v=kt(n);this.queue.set(v,p);try{await await ti(this.rpcPublish(i,n,a,u,l,h),this.publishTimeout),this.relayer.events.emit(Ve.publish,p)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ve.connection_stalled);return}this.onPublish(v,p),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=_e.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return _e.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,a){var u,l,h,p;const v={method:ri(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:a}};return ut((u=v.params)==null?void 0:u.prompt)&&((l=v.params)==null||delete l.prompt),ut((h=v.params)==null?void 0:h.tag)&&((p=v.params)==null||delete p.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:v}),this.relayer.request(v)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class py{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var gy=Object.defineProperty,yy=Object.defineProperties,_y=Object.getOwnPropertyDescriptors,ma=Object.getOwnPropertySymbols,by=Object.prototype.hasOwnProperty,wy=Object.prototype.propertyIsEnumerable,Ea=(t,e,r)=>e in t?gy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fr=(t,e)=>{for(var r in e||(e={}))by.call(e,r)&&Ea(t,r,e[r]);if(ma)for(var r of ma(e))wy.call(e,r)&&Ea(t,r,e[r]);return t},xn=(t,e)=>yy(t,_y(e));class vy extends sh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new py,this.events=new lt.exports.EventEmitter,this.name=ty,this.version=ry,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ut,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=hn(n),a={topic:i,relay:s};this.pending.set(i,a);const u=await this.rpcSubscribe(i,s);return this.onSubscribe(u,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const a=new Q.Watch;a.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),a.stop(this.pendingSubscriptionWatchLabel),n(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=iy&&(clearInterval(u),a.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=_e.generateChildLogger(r,this.name),this.clientId=""}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=hn(i);await this.rpcUnsubscribe(e,r,n);const s=Ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:ri(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await ti(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}return kt(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:ri(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await ti(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:ri(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,xn(Fr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Fr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Fr({},r)),this.topicMap.set(r.topic,e),this.events.emit(xt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(xt.deleted,xn(Fr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(xt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Tr(r)&&this.onBatchSubscribe(r.map((i,n)=>xn(Fr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ve.connect,async()=>{await this.onConnect()}),this.relayer.on(Ve.disconnect,()=>{this.onDisconnect()}),this.events.on(xt.created,async e=>{const r=xt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(xt.deleted,async e=>{const r=xt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var my=Object.defineProperty,Sa=Object.getOwnPropertySymbols,Ey=Object.prototype.hasOwnProperty,Sy=Object.prototype.propertyIsEnumerable,Da=(t,e,r)=>e in t?my(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dy=(t,e)=>{for(var r in e||(e={}))Ey.call(e,r)&&Da(t,r,e[r]);if(Sa)for(var r of Sa(e))Sy.call(e,r)&&Da(t,r,e[r]);return t};class Oy extends ih{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new lt.exports.EventEmitter,this.name=X0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?_e.generateChildLogger(e.logger,this.name):_e.pino(_e.getDefaultLoggerOptions({level:e.logger||k0})),this.messages=new fy(this.logger,e.core),this.subscriber=new vy(this,this.logger),this.publisher=new dy(this,this.logger),this.relayUrl=e?.relayUrl||ba,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return _e.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(xt.created,s=>{s.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ve.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(xt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,i)=>{await ti(this.provider.connect(),5e3,"socket stalled").catch(n=>i(n)).then(()=>r()).finally(()=>this.removeListener(Ve.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ve.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.events.emit(Ve.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await Promise.all([new Promise(r=>{this.provider.once(Cr.disconnect,()=>{r()})}),this.transportClose()]),await new Promise(r=>setTimeout(r,1e3)),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ag(new lg(Ld({sdkVersion:Z0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),wn(e)){if(!e.method.endsWith(J0))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,a={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Dy({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ve.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=_n(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Cr.payload,e=>this.onProviderPayload(e)),this.provider.on(Cr.connect,()=>{this.events.emit(Ve.connect)}),this.provider.on(Cr.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Cr.error,e=>{this.logger.error(e),this.events.emit(Ve.error,e)})}registerEventListeners(){this.events.on(Ve.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ve.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Q.toMiliseconds(Q0))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var xy=Object.defineProperty,Oa=Object.getOwnPropertySymbols,Iy=Object.prototype.hasOwnProperty,Ty=Object.prototype.propertyIsEnumerable,xa=(t,e,r)=>e in t?xy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ia=(t,e)=>{for(var r in e||(e={}))Iy.call(e,r)&&xa(t,r,e[r]);if(Oa)for(var r of Oa(e))Ty.call(e,r)&&xa(t,r,e[r]);return t};class oi extends nh{constructor(e,r,i,n=Ut,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=ey,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!ut(a)?this.map.set(this.getKey(a),a):tp(a)?this.map.set(a.id,a):rp(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,u)=>{this.isInitialized(),this.map.has(a)?await this.update(a,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:u}),this.map.set(a,u),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(u=>Object.keys(a).every(l=>fg(u[l],a[l]))):this.values),this.update=async(a,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:u});const l=Ia(Ia({},this.getData(a)),u);this.map.set(a,l),await this.persist()},this.delete=async(a,u)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:u}),this.map.delete(a),await this.persist())},this.logger=_e.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ny{constructor(e,r){this.core=e,this.logger=r,this.name=ny,this.version=sy,this.events=new lt.exports,this.initialized=!1,this.storagePrefix=Ut,this.ignoredPayloadTypes=[Yt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=an(),n=await this.core.crypto.setSymKey(i),s=mt(Q.FIVE_MINUTES),a={protocol:_a},u={topic:n,expiry:s,relay:a,active:!1},l=Vd({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a});return await this.pairings.set(n,u),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:l}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:a}=Kd(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const u=mt(Q.FIVE_MINUTES),l={topic:n,relay:a,expiry:u,active:!1};return await this.pairings.set(n,l),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:a}),this.core.expirer.set(n,u),i.activatePairing&&await this.activate({topic:n}),l},this.activate=async({topic:i})=>{this.isInitialized();const n=mt(Q.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:u,reject:l}=or();this.events.once(Ue("pairing_ping",s),({error:h})=>{h?l(h):u()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const a=ni(n,s),u=await this.core.crypto.encode(i,a),l=Lr[n].req;return this.core.history.set(i,a),await this.core.relayer.publish(i,u,l),a.id},this.sendResult=async(i,n,s)=>{const a=_n(i,s),u=await this.core.crypto.encode(n,a),l=await this.core.history.get(n,i),h=Lr[l.request.method].res;await this.core.relayer.publish(n,u,h),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=bn(i,s),u=await this.core.crypto.encode(n,a),l=await this.core.history.get(n,i),h=Lr[l.request.method]?Lr[l.request.method].res:Lr.unregistered_method.res;await this.core.relayer.publish(n,u,h),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Ft(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i,a=s.method;if(this.pairings.keys.includes(n))switch(a){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;if(this.pairings.keys.includes(n))switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{At(n)?this.events.emit(Ue("pairing_ping",s),{}):Et(n)&&this.events.emit(Ue("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const u=Ke("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,u),this.logger.error(u)}catch(u){await this.sendError(s,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!dt(i)){const{message:n}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!ep(i.uri)){const{message:n}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!dt(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!dt(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!He(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Ft(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=_e.generateChildLogger(r,this.name),this.pairings=new oi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return _e.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);wn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):vn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(_t.expired,async e=>{const{topic:r}=Ao(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Py extends eh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new lt.exports.EventEmitter,this.name=oy,this.version=ay,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(It.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Et(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(It.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:ni(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(It.created,e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.updated,e=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.deleted,e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ay extends oh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new lt.exports.EventEmitter,this.name=cy,this.version=uy,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(_t.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(_t.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Fd(e);if(typeof e=="number")return Ud(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(_t.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.expired,e=>{const r=_t.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ry extends ah{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=wa,this.initialized=!1,this.init=async i=>{!un()||!document||(this.verifyUrl=i?.verifyUrl||va,await this.createIframe())},this.register=async i=>{var n;this.initialized||await this.init(),this.iframe&&((n=this.iframe.contentWindow)==null||n.postMessage(i.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${i.attestationId} ${this.verifyUrl}`))},this.resolve=async i=>{var n;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${i.attestationId}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),a=await fetch(`${this.verifyUrl}/attestation/${i.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),((n=await a.json())==null?void 0:n.origin)||""},this.createIframe=async()=>{try{const i=this.startAbortTimer(Q.FIVE_SECONDS);await Promise.race([new Promise((n,s)=>{const a=document.createElement("iframe");a.setAttribute("id",wa),a.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),a.style.display="none",a.addEventListener("load",()=>{this.initialized=!0,clearTimeout(i),n()}),a.addEventListener("error",u=>{s(u)}),document.body.append(a),this.iframe=a}),new Promise(n=>{this.abortController.signal.addEventListener("abort",()=>{n("iframe load timeout")})})])}catch(i){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(i)}},this.logger=_e.generateChildLogger(r,this.name),this.verifyUrl=va,this.abortController=new AbortController,this.isDevEnv=cn()&&process.env.IS_VITEST}get context(){return _e.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),mt(e))}}var Cy=Object.defineProperty,Ta=Object.getOwnPropertySymbols,Ly=Object.prototype.hasOwnProperty,Fy=Object.prototype.propertyIsEnumerable,Na=(t,e,r)=>e in t?Cy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pa=(t,e)=>{for(var r in e||(e={}))Ly.call(e,r)&&Na(t,r,e[r]);if(Ta)for(var r of Ta(e))Fy.call(e,r)&&Na(t,r,e[r]);return t};class In extends Zu{constructor(e){super(e),this.protocol=ga,this.version=M0,this.name=On,this.events=new lt.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||ba;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:_e.pino(_e.getDefaultLoggerOptions({level:e?.logger||j0.logger}));this.logger=_e.generateChildLogger(r,this.name),this.heartbeat=new gr.HeartBeat,this.crypto=new ly(this,this.logger,e?.keychain),this.history=new Py(this,this.logger),this.expirer=new Ay(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Nc(Pa(Pa({},z0),e?.storageOptions)),this.relayer=new Oy({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ny(this,this.logger),this.verify=new Ry(this.projectId||"",this.logger)}static async init(e){const r=new In(e);return await r.initialize(),r}get context(){return _e.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Uy=In,Tn="wc",Nn=2,Pn="client",ai=`${Tn}@${Nn}:${Pn}:`,ci={name:Pn,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},$y={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},My={database:":memory:"},jy={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},zy="history",By="0.3",Aa="proposal",qy=Q.THIRTY_DAYS,Ra="Proposal expired",Ca="session",Ur=Q.SEVEN_DAYS,La="engine",cr={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}},ui={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},Fa="request",Ua=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Ky=Object.defineProperty,Hy=Object.defineProperties,Vy=Object.getOwnPropertyDescriptors,$a=Object.getOwnPropertySymbols,Gy=Object.prototype.hasOwnProperty,Wy=Object.prototype.propertyIsEnumerable,Ma=(t,e,r)=>e in t?Ky(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e)=>{for(var r in e||(e={}))Gy.call(e,r)&&Ma(t,r,e[r]);if($a)for(var r of $a(e))Wy.call(e,r)&&Ma(t,r,e[r]);return t},An=(t,e)=>Hy(t,Vy(e));class Yy extends uh{constructor(e){super(e),this.name=La,this.events=new lt.exports,this.initialized=!1,this.ignoredPayloadTypes=[Yt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(cr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=An(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:u,relays:l}=i;let h=n,p,v=!1;if(h&&(v=this.client.core.pairing.pairings.get(h).active),!h||!v){const{topic:I,uri:y}=await this.client.core.pairing.create();h=I,p=y}const _=await this.client.core.crypto.generateKeyPair(),m=bt({requiredNamespaces:s,optionalNamespaces:a,relays:l??[{protocol:_a}],proposer:{publicKey:_,metadata:this.client.metadata}},u&&{sessionProperties:u}),{reject:S,resolve:A,done:R}=or(Q.FIVE_MINUTES,Ra);if(this.events.once(Ue("session_connect"),async({error:I,session:y})=>{if(I)S(I);else if(y){y.self.publicKey=_;const w=An(bt({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,w),await this.setExpiry(y.topic,y.expiry),h&&await this.client.core.pairing.updateMetadata({topic:h,metadata:y.peer.metadata}),A(w)}}),!h){const{message:I}=V("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw new Error(I)}const q=await this.sendRequest(h,"wc_sessionPropose",m),E=mt(Q.FIVE_MINUTES);return await this.setProposal(q,bt({id:q,expiry:E},m)),{uri:p,approval:R}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:a}=r,u=this.client.proposal.get(i);let{pairingTopic:l,proposer:h,requiredNamespaces:p,optionalNamespaces:v}=u;l=l||"",Nr(p)||(p=kd(s,"approve()"));const _=await this.client.core.crypto.generateKeyPair(),m=h.publicKey,S=await this.client.core.crypto.generateSharedKey(_,m);l&&i&&(await this.client.core.pairing.updateMetadata({topic:l,metadata:h.metadata}),await this.sendResult(i,l,{relay:{protocol:n??"irn"},responderPublicKey:_}),await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}));const A=bt({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:p,optionalNamespaces:v,pairingTopic:l,controller:{publicKey:_,metadata:this.client.metadata},expiry:mt(Ur)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(S),await this.sendRequest(S,"wc_sessionSettle",A);const R=An(bt({},A),{topic:S,pairingTopic:l,acknowledged:!1,self:A.controller,peer:{publicKey:h.publicKey,metadata:h.metadata},controller:_});return await this.client.session.set(S,R),await this.setExpiry(S,mt(Ur)),{topic:S,acknowledged:()=>new Promise(q=>q(this.client.session.get(S)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:a,resolve:u,reject:l}=or();return this.events.once(Ue("session_update",s),({error:h})=>{h?l(h):u()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:a,reject:u}=or();return this.events.once(Ue("session_extend",n),({error:l})=>{l?u(l):a()}),await this.setExpiry(i,mt(Ur)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:a}=r,u=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},a),{done:l,resolve:h,reject:p}=or(a);return this.events.once(Ue("session_request",u),({error:v,result:_})=>{v?p(v):h(_)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:u}),await l()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;At(n)?await this.sendResult(s,i,n.result):Et(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:a,reject:u}=or();this.events.once(Ue("session_ping",n),({error:l})=>{l?u(l):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Ke("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Qd(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Ke("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=cr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:a}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:a}),i&&this.client.core.expirer.set(n,mt(i))},this.sendRequest=async(r,i,n,s)=>{const a=ni(i,n);if(un()&&Ua.includes(i)){const h=kt(JSON.stringify(a));await this.client.core.verify.register({attestationId:h})}const u=await this.client.core.crypto.encode(r,a),l=cr[i].req;return s&&(l.ttl=s),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,u,l),a.id},this.sendResult=async(r,i,n)=>{const s=_n(r,n),a=await this.client.core.crypto.encode(i,s),u=await this.client.core.history.get(i,r),l=cr[u.request.method].res;this.client.core.relayer.publish(i,a,l),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=bn(r,n),a=await this.client.core.crypto.encode(i,s),u=await this.client.core.history.get(i,r),l=cr[u.request.method].res;this.client.core.relayer.publish(i,a,l),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{Ft(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ft(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(bt({},i.params));const a=mt(Q.FIVE_MINUTES),u=bt({id:s,pairingTopic:r,expiry:a},n);await this.setProposal(s,u);const l=kt(JSON.stringify(i)),h=await this.getVerifyContext(l,u.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:u,context:h})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(At(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const u=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const l=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const h=await this.client.core.crypto.generateSharedKey(u,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const p=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:p}),await this.client.core.pairing.activate({topic:r})}else Et(i)&&(await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:u,expiry:l,namespaces:h,requiredNamespaces:p,optionalNamespaces:v,sessionProperties:_,pairingTopic:m}=i.params,S=bt({topic:r,relay:a,expiry:l,namespaces:h,acknowledged:!0,pairingTopic:m,requiredNamespaces:p,optionalNamespaces:v,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},_&&{sessionProperties:_});await this.sendResult(i.id,r,!0),this.events.emit(Ue("session_connect"),{session:S})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;At(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",n),{})):Et(i)&&(await this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(bt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_update",n),{}):Et(i)&&this.events.emit(Ue("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,mt(Ur)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_extend",n),{}):Et(i)&&this.events.emit(Ue("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{At(i)?this.events.emit(Ue("session_ping",n),{}):Et(i)&&this.events.emit(Ue("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(Ve.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult(n,r,!0)]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(bt({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s});const a=kt(JSON.stringify(i)),u=this.client.session.get(r),l=await this.getVerifyContext(a,u.peer.metadata);this.client.events.emit("session_request",{id:n,topic:r,params:s,context:l})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_request",n),{result:i.result}):Et(i)&&this.events.emit(Ue("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(bt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:l}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:u}=r;if(ut(i)||await this.isValidPairingTopic(i),!hp(u,!0)){const{message:l}=V("MISSING_OR_INVALID",`connect() relays: ${u}`);throw new Error(l)}!ut(n)&&Nr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ut(s)&&Nr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ut(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=up(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!dt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(i);const u=this.client.proposal.get(i),l=ii(n,"approve()");if(l)throw new Error(l.message);const h=Mo(u.requiredNamespaces,n,"approve()");if(h)throw new Error(h.message);if(!He(s,!0)){const{message:p}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(p)}ut(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!fp(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:h}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!Uo(i)){const{message:h}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const u=ip(n,"onSessionSettleRequest()");if(u)throw new Error(u.message);const l=ii(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(Ft(a)){const{message:h}=V("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:l}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(l)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=ii(n,"update()");if(a)throw new Error(a.message);const u=Mo(s.requiredNamespaces,n,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!dt(r)){const{message:l}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(l)}const{topic:i,request:n,chainId:s,expiry:a}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!$o(u,s)){const{message:l}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(l)}if(!dp(n)){const{message:l}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(l)}if(!yp(u,s,n.method)){const{message:l}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(l)}if(a&&!vp(a,ui)){const{message:l}=V("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${ui.min} and ${ui.max}`);throw new Error(l)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!pp(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!dt(r)){const{message:u}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(u)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!$o(a,s)){const{message:u}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(u)}if(!gp(n)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}if(!_p(a,s,n.name)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||"",validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});n.verified.origin=s,n.verified.validation=s===i.url?"VALID":"INVALID"}catch(s){this.client.logger.error(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!He(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);wn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):vn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(_t.expired,async e=>{const{topic:r,id:i}=Ao(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!He(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!He(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(He(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!lp(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class ky extends oi{constructor(e,r){super(e,r,Aa,ai),this.core=e,this.logger=r}}class Xy extends oi{constructor(e,r){super(e,r,Ca,ai),this.core=e,this.logger=r}}class Jy extends oi{constructor(e,r){super(e,r,Fa,ai,i=>i.id),this.core=e,this.logger=r}}class hi extends ch{constructor(e){super(e),this.protocol=Tn,this.version=Nn,this.name=ci.name,this.events=new lt.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||ci.name,this.metadata=e?.metadata||Pd();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:_e.pino(_e.getDefaultLoggerOptions({level:e?.logger||ci.logger}));this.core=e?.core||new Uy(e),this.logger=_e.generateChildLogger(r,this.name),this.session=new Xy(this.core,this.logger),this.proposal=new ky(this.core,this.logger),this.pendingRequest=new Jy(this.core,this.logger),this.engine=new Yy(this)}static async init(e){const r=new hi(e);return await r.initialize(),r}get context(){return _e.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const Qy=hi;xe.ENGINE_CONTEXT=La,xe.ENGINE_RPC_OPTS=cr,xe.HISTORY_CONTEXT=zy,xe.HISTORY_EVENTS=jy,xe.HISTORY_STORAGE_VERSION=By,xe.METHODS_TO_VERIFY=Ua,xe.PROPOSAL_CONTEXT=Aa,xe.PROPOSAL_EXPIRY=qy,xe.PROPOSAL_EXPIRY_MESSAGE=Ra,xe.REQUEST_CONTEXT=Fa,xe.SESSION_CONTEXT=Ca,xe.SESSION_EXPIRY=Ur,xe.SESSION_REQUEST_EXPIRY_BOUNDARIES=ui,xe.SIGN_CLIENT_CONTEXT=Pn,xe.SIGN_CLIENT_DEFAULT=ci,xe.SIGN_CLIENT_EVENTS=$y,xe.SIGN_CLIENT_PROTOCOL=Tn,xe.SIGN_CLIENT_STORAGE_OPTIONS=My,xe.SIGN_CLIENT_STORAGE_PREFIX=ai,xe.SIGN_CLIENT_VERSION=Nn,xe.SignClient=Qy,xe.default=hi,Object.defineProperty(xe,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
